import{g as e,s,b as t,d as a,l as r,w as o,m as c,o as l,p as d,t as n,y as i,u,z as h,A as m,F as f,B as g,C as p,K as C,D as _,x}from"./index-BFyEvU8g.js";import{_ as w}from"./search-icon.CtyLh-PK.js";import{_ as W}from"./empty-icon.8qvP3JRT.js";import{_ as k}from"./_plugin-vue_export-helper.BCo6x5W8.js";const P=k({data:()=>({allCharacters:[],filteredCharacters:[],customWords:[],searchText:"",currentPage:1,pageSize:10,expandedIndex:-1,newWords:{}}),computed:{totalPages(){return Math.ceil(this.filteredCharacters.length/this.pageSize)},paginatedCharacters(){const e=(this.currentPage-1)*this.pageSize,s=e+this.pageSize;return this.filteredCharacters.slice(e,s)},customWordsCount(){return this.customWords.length}},onLoad(){this.loadData(),wx.showShareMenu({withShareTicket:!0,menus:["shareAppMessage","shareTimeline"]})},onShareAppMessage:()=>({title:"方舟通行证谷子查询工具-自定义搜索词",path:"/packageA/custom-words/custom-words",imageUrl:""}),onShareTimeline:()=>({title:"方舟通行证谷子查询工具-关于我们",imageUrl:""}),methods:{loadData(){try{const t=e("searchWords");t&&Array.isArray(t)&&(this.allCharacters=t,this.filteredCharacters=[...t]);const a=e("customSearchWords");a&&Array.isArray(a)?this.customWords=a:(this.customWords=[],s("customSearchWords",[])),console.log(`加载数据: ${this.allCharacters.length} 个干员, ${this.customWords.length} 个自定义词`)}catch(a){console.error("加载数据失败:",a),t({title:"加载数据失败",icon:"error"})}},onSearchInput(){if(this.currentPage=1,this.expandedIndex=-1,!this.searchText.trim())return void(this.filteredCharacters=[...this.allCharacters]);const e=this.searchText.trim().toLowerCase();this.filteredCharacters=this.allCharacters.filter((s=>s.name.toLowerCase().includes(e)||s.englishname&&s.englishname.toLowerCase().includes(e)||this.checkCustomWordsMatch(s.name,e)))},checkCustomWordsMatch(e,s){const t=this.customWords.find((s=>s.characterName===e));return!(!t||!t.words)&&t.words.some((e=>e.toLowerCase().includes(s)))},clearSearch(){this.searchText="",this.filteredCharacters=[...this.allCharacters],this.currentPage=1},toggleExpand(e){this.expandedIndex===e?this.expandedIndex=-1:this.expandedIndex=e},getCustomWords(e){const s=this.customWords.find((s=>s.characterName===e));return s?s.words:[]},getCustomWordCount(e){return this.getCustomWords(e).length},addCustomWord(e){const a=this.newWords[e]?this.newWords[e].trim():"";if(!a)return void t({title:"请输入搜索词",icon:"none"});if(a.length>10)return void t({title:"搜索词不能超过10个字符",icon:"none"});if([...this.allCharacters.find((s=>s.name===e)).searchword||[],...this.getCustomWords(e)].some((e=>e.toLowerCase()===a.toLowerCase())))return void t({title:"该搜索词已存在",icon:"none"});let r=this.customWords.find((s=>s.characterName===e));if(r){if(r.words.length>=5)return void t({title:"最多添加5个自定义搜索词",icon:"none"});r.words.push(a)}else r={characterName:e,words:[a]},this.customWords.push(r);s("customSearchWords",this.customWords),this.$set(this.newWords,e,""),t({title:"添加成功",icon:"success"}),console.log(`为干员 ${e} 添加搜索词: ${a}`)},removeCustomWord(e,r){a({title:"确认删除",content:`确定要删除"${r}"吗？`,confirmText:"删除",confirmColor:"#FA5151",success:a=>{if(a.confirm){const a=this.customWords.find((s=>s.characterName===e));if(a){const o=a.words.indexOf(r);if(o>-1&&a.words.splice(o,1),0===a.words.length){const e=this.customWords.indexOf(a);e>-1&&this.customWords.splice(e,1)}s("customSearchWords",this.customWords),t({title:"删除成功",icon:"success"}),console.log(`删除干员 ${e} 的搜索词: ${r}`)}}}})},prevPage(){this.currentPage>1&&(this.currentPage--,this.expandedIndex=-1)},nextPage(){this.currentPage<this.totalPages&&(this.currentPage++,this.expandedIndex=-1)},goToFirstPage(){this.currentPage=1},goToLastPage(){this.currentPage=this.totalPages}}},[["render",function(e,s,t,a,k,P){const y=g,b=c,S=p,T=C,I=_;return l(),r(b,{class:"container"},{default:o((()=>[d(b,{class:"header"},{default:o((()=>[d(y,{class:"subtitle"},{default:o((()=>[n("为干员添加个人常用的别名和搜索词")])),_:1})])),_:1}),d(b,{class:"search-section"},{default:o((()=>[d(b,{class:"search-input-container"},{default:o((()=>[d(S,{class:"search-icon",src:w}),d(T,{class:"search-input",modelValue:k.searchText,"onUpdate:modelValue":s[0]||(s[0]=e=>k.searchText=e),placeholder:"搜索干员名称",onInput:P.onSearchInput},null,8,["modelValue","onInput"]),k.searchText?(l(),r(y,{key:0,class:"clear-search",onClick:P.clearSearch},{default:o((()=>[n("×")])),_:1},8,["onClick"])):i("",!0)])),_:1})])),_:1}),d(b,{class:"stats-section"},{default:o((()=>[d(y,{class:"stats-text"},{default:o((()=>[n("共 "+u(k.filteredCharacters.length)+" 个干员",1)])),_:1}),d(y,{class:"stats-text"},{default:o((()=>[n("已为 "+u(P.customWordsCount)+" 个干员添加自定义搜索词",1)])),_:1})])),_:1}),d(b,{class:"character-list"},{default:o((()=>[(l(!0),h(f,null,m(P.paginatedCharacters,((e,s)=>(l(),r(b,{class:x(["character-item",{expanded:k.expandedIndex===s}]),key:e.name},{default:o((()=>[d(b,{class:"character-header",onClick:e=>P.toggleExpand(s)},{default:o((()=>[d(b,{class:"character-info"},{default:o((()=>[d(y,{class:"character-name"},{default:o((()=>[n(u(e.name),1)])),_:2},1024),e.englishname?(l(),r(y,{key:0,class:"character-english"},{default:o((()=>[n(u(e.englishname),1)])),_:2},1024)):i("",!0)])),_:2},1024),d(b,{class:"character-actions"},{default:o((()=>[P.getCustomWordCount(e.name)>0?(l(),r(y,{key:0,class:"custom-count"},{default:o((()=>[n(u(P.getCustomWordCount(e.name))+"个自定义 ",1)])),_:2},1024)):i("",!0),d(y,{class:"expand-icon"},{default:o((()=>[n(u(k.expandedIndex===s?"−":"+"),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"]),k.expandedIndex===s?(l(),r(b,{key:0,class:"character-details"},{default:o((()=>[d(b,{class:"word-section"},{default:o((()=>[d(y,{class:"section-title"},{default:o((()=>[n("固定外号")])),_:1}),d(b,{class:"word-list"},{default:o((()=>[(l(!0),h(f,null,m(e.searchword,(e=>(l(),r(b,{class:"word-tag fixed",key:e},{default:o((()=>[d(y,{class:"word-text"},{default:o((()=>[n(u(e),1)])),_:2},1024)])),_:2},1024)))),128)),e.searchword&&0!==e.searchword.length?i("",!0):(l(),r(y,{key:0,class:"no-words"},{default:o((()=>[n(" 暂无固定外号 ")])),_:1}))])),_:2},1024)])),_:2},1024),d(b,{class:"word-section"},{default:o((()=>[d(b,{class:"section-header"},{default:o((()=>[d(y,{class:"section-title"},{default:o((()=>[n("自定义搜索词")])),_:1}),d(y,{class:"section-desc"},{default:o((()=>[n("最多添加5个自定义搜索词")])),_:1})])),_:1}),d(b,{class:"word-list"},{default:o((()=>[(l(!0),h(f,null,m(P.getCustomWords(e.name),(s=>(l(),r(b,{class:"word-tag custom",key:s},{default:o((()=>[d(y,{class:"word-text"},{default:o((()=>[n(u(s),1)])),_:2},1024),d(y,{class:"delete-icon",onClick:t=>P.removeCustomWord(e.name,s)},{default:o((()=>[n("×")])),_:2},1032,["onClick"])])),_:2},1024)))),128)),0===P.getCustomWordCount(e.name)?(l(),r(y,{key:0,class:"no-words"},{default:o((()=>[n(" 暂无自定义搜索词 ")])),_:1})):i("",!0)])),_:2},1024),P.getCustomWordCount(e.name)<5?(l(),r(b,{key:0,class:"add-word-section"},{default:o((()=>[d(T,{class:"add-word-input",modelValue:k.newWords[e.name],"onUpdate:modelValue":s=>k.newWords[e.name]=s,placeholder:`为${e.name}添加搜索词`,maxlength:"10",onConfirm:s=>P.addCustomWord(e.name)},null,8,["modelValue","onUpdate:modelValue","placeholder","onConfirm"]),d(I,{class:"add-word-btn",onClick:s=>P.addCustomWord(e.name),disabled:!k.newWords[e.name]||""===k.newWords[e.name].trim()},{default:o((()=>[n(" 添加 ")])),_:2},1032,["onClick","disabled"])])),_:2},1024)):(l(),r(y,{key:1,class:"max-tip"},{default:o((()=>[n("已达到最多5个自定义搜索词")])),_:1}))])),_:2},1024)])),_:2},1024)):i("",!0)])),_:2},1032,["class"])))),128))])),_:1}),P.totalPages>1?(l(),r(b,{key:0,class:"pagination"},{default:o((()=>[d(I,{class:"page-btn",disabled:k.currentPage<=1,onClick:P.goToFirstPage},{default:o((()=>[n(" 首页 ")])),_:1},8,["disabled","onClick"]),d(I,{class:"page-btn",disabled:1===k.currentPage,onClick:P.prevPage},{default:o((()=>[n(" 上一页 ")])),_:1},8,["disabled","onClick"]),d(y,{class:"page-info"},{default:o((()=>[n("第 "+u(k.currentPage)+" 页 / 共 "+u(P.totalPages)+" 页",1)])),_:1}),d(I,{class:"page-btn",disabled:k.currentPage===P.totalPages,onClick:P.nextPage},{default:o((()=>[n(" 下一页 ")])),_:1},8,["disabled","onClick"]),d(I,{class:"page-btn",disabled:k.currentPage>=P.totalPages,onClick:P.goToLastPage},{default:o((()=>[n(" 尾页 ")])),_:1},8,["disabled","onClick"])])),_:1})):i("",!0),0===k.filteredCharacters.length?(l(),r(b,{key:1,class:"empty-state"},{default:o((()=>[d(S,{class:"empty-icon",src:W}),d(y,{class:"empty-text"},{default:o((()=>[n("未找到相关干员")])),_:1}),k.searchText?(l(),r(y,{key:0,class:"empty-tip"},{default:o((()=>[n("尝试调整搜索词")])),_:1})):i("",!0)])),_:1})):i("",!0),d(b,{class:"tip-section"},{default:o((()=>[d(y,{class:"tip-text"},{default:o((()=>[n("• 固定外号来自问卷征集，无法修改或删除")])),_:1}),d(y,{class:"tip-text"},{default:o((()=>[n("• 每个干员最多可添加5个自定义搜索词")])),_:1}),d(y,{class:"tip-text"},{default:o((()=>[n('• 自定义搜索词将在"外号搜索"启用时生效')])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-42ceefcd"]]);export{P as default};
