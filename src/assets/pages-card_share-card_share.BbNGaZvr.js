import{H as e,g as t,s as a,b as s,a as l,r,h as i,d as o,i as n,O as c,P as h,Q as d,L as u,R as g,l as f,w as C,m,o as w,p,x as _,t as y,u as x,z as v,A as b,F as S,y as k,q as T,B as E,D,I as B,C as F,J as I,G as A,T as L,K as M}from"./index-BFyEvU8g.js";import{_ as $}from"./empty-icon.8qvP3JRT.js";import{_ as P}from"./_plugin-vue_export-helper.BCo6x5W8.js";const O=P({data:()=>({characterData:[],filteredBoxes:[],displayBoxes:[],ownedCharacters:{},wantedCharacters:[],tradeCharacters:{},currentMode:"show",wantMode:!1,eliteLevel:"all",boxFilterIndex:0,boxFilterOptions:["å…¨éƒ¨ç›’å­","å¸¸è§„æ¬¾","ç™½åå•","ç‰¹åˆ«é€šè¡Œ","è”åŠ¨æ¬¾","éŸ³å¾‹è”è§‰"],boxFilterMap:{0:"all",1:"normal",2:"whitelist",3:"special",4:"cooperation",5:"ambience"},pageSize:3,currentPage:1,hasMore:!0,scrollTop:0,showSharePreviewModal:!1,isGeneratingShareImage:!1,shareImagePath:"",shareShowPrices:!0,shareShowWanted:!0,watermarkText:"æ˜æ—¥æ–¹èˆŸé€šè¡Œè¯æ”¶é›†",shareGeneratedTime:"",defaultAvatar:"/static/default-avatar.png",ownedCount:0,wantedCount:0,tradeCount:0,totalCharacters:0,emptyText:"æš‚æ— æ•°æ®æˆ–æ²¡æœ‰ç¬¦åˆæ¡ä»¶çš„è§’è‰²",showDebugModal:!1,localStorage:{},testResult:"",isLoading:!1}),computed:{currentBoxFilter(){return this.boxFilterMap[this.boxFilterIndex]||"all"},isAllSelected(){const e=this.getAllCharactersList();return 0!==e.length&&e.every((e=>e&&this.isCharacterOwned(e.name)))}},onLoad(){console.log("æˆ‘çš„æ”¶è—é¡µé¢åŠ è½½"),e({title:"æˆ‘çš„é€šè¡Œè¯åˆ†äº«"}),this.initData()},onShow(){this.loadUserData()},onShareAppMessage:()=>({title:"æ–¹èˆŸé€šè¡Œè¯è°·å­æŸ¥è¯¢å·¥å…·-é€šè¡Œè¯åˆ†äº«",path:"/pages/card_share/card_share",imageUrl:""}),onShareTimeline:()=>({title:"æ–¹èˆŸé€šè¡Œè¯è°·å­æŸ¥è¯¢å·¥å…·-é€šè¡Œè¯åˆ†äº«",imageUrl:""}),methods:{async initData(){console.log("å¼€å§‹åˆå§‹åŒ–æ•°æ®..."),await this.checkLocalStorage(),await this.loadData(),this.loadUserData(),console.log("æ•°æ®åˆå§‹åŒ–å®Œæˆ")},async checkLocalStorage(){try{console.log("æ£€æŸ¥æœ¬åœ°å­˜å‚¨...");const e={};if(["arknightsData","arknightsDataString","favoriteCharacterNames","enableGuessData","guessData","dataUrl","dataVersion"].forEach((a=>{try{const s=t(a);e[a]=s,console.log(`${a}:`,s?Array.isArray(s)?`æ•°ç»„[${s.length}]`:typeof s:"ç©º")}catch(s){console.error(`è¯»å–${a}å¤±è´¥:`,s),e[a]=null}})),this.localStorage=e,e.arknightsData&&Array.isArray(e.arknightsData)&&e.arknightsData.length>0){console.log("å‘ç°æœ¬åœ°æ•°æ®:",e.arknightsData.length,"ä¸ªç›’å­");const t=e.arknightsData[0];console.log("ç¬¬ä¸€ä¸ªç›’å­:",{Box_id:t.Box_id,Box_type:t.Box_type,character1:t.character1,character1_type:typeof t.character1})}else e.arknightsDataString?console.log("å‘ç°å­—ç¬¦ä¸²æ ¼å¼æ•°æ®"):(console.log("æœªå‘ç°æœ¬åœ°æ•°æ®"),this.emptyText="è¯·å…ˆè¿”å›åˆ—è¡¨é¡µé¢åŠ è½½æ•°æ®")}catch(e){console.error("æ£€æŸ¥æœ¬åœ°å­˜å‚¨å¤±è´¥:",e)}},async loadData(){if(!this.isLoading){this.isLoading=!0,console.log("å¼€å§‹åŠ è½½è§’è‰²æ•°æ®...");try{let t=[],l="";if(this.localStorage.arknightsData&&Array.isArray(this.localStorage.arknightsData))t=[...this.localStorage.arknightsData],l="arknightsData",console.log(`ä»${l}åŠ è½½ï¼Œæ•°é‡: ${t.length}`);else{if(!this.localStorage.arknightsDataString)return console.log("æœ¬åœ°æ— æ•°æ®ï¼Œå°è¯•ä»ç½‘ç»œåŠ è½½..."),await this.loadDataFromNetwork(),void(this.isLoading=!1);try{const e=JSON.parse(this.localStorage.arknightsDataString);Array.isArray(e)&&e.length>0&&(t=e,l="arknightsDataString",console.log(`ä»${l}åŠ è½½ï¼Œæ•°é‡: ${t.length}`),a("arknightsData",e),this.localStorage.arknightsData=e)}catch(e){console.error("è§£æå­—ç¬¦ä¸²æ•°æ®å¤±è´¥:",e)}}if("true"===this.localStorage.enableGuessData&&this.localStorage.guessData&&Array.isArray(this.localStorage.guessData)&&this.localStorage.guessData.length>0&&(console.log("åˆå¹¶é¢„æµ‹æ•°æ®ï¼Œæ•°é‡:",this.localStorage.guessData.length),t=[...t,...this.localStorage.guessData]),t.length>0){console.log(`æ€»æ•°æ®é‡: ${t.length}`);const e=this.validateAndFixData(t);console.log(`éªŒè¯åæ•°æ®é‡: ${e.length}`),this.characterData=e,this.applyFilter(),this.calculateStatistics(),0===e.length?this.emptyText="æ•°æ®æ ¼å¼ä¸æ­£ç¡®ï¼Œè¯·é‡æ–°åŠ è½½":0===this.filteredBoxes.length?this.emptyText="æ²¡æœ‰ç¬¦åˆæ¡ä»¶çš„è§’è‰²":this.emptyText=`å·²åŠ è½½${e.length}ä¸ªç›’å­`,s({title:`åŠ è½½æˆåŠŸ (${e.length}ä¸ªç›’å­)`,icon:"success",duration:1500})}else console.log("æ— æ•°æ®å¯ç”¨"),this.showNoDataMessage()}catch(t){console.error("åŠ è½½æ•°æ®å¤±è´¥:",t),s({title:"åŠ è½½æ•°æ®å¤±è´¥",icon:"none"}),this.emptyText="åŠ è½½æ•°æ®å¤±è´¥ï¼Œè¯·é‡è¯•"}finally{this.isLoading=!1}}},async loadDataFromNetwork(){try{l({title:"åŠ è½½ä¸­..."});const t=this.localStorage.dataUrl||"https://raw.gitcode.com/huangjinzhou1/ArknightsAuthorization_Series/raw/main/Box_Id.json";console.log("ä»ç½‘ç»œåŠ è½½æ•°æ®ï¼ŒURL:",t);const o=await new Promise(((e,a)=>{r({url:t,method:"GET",timeout:1e4,success:e,fail:a})}));if(i(),200!==o.statusCode)throw new Error(`æœåŠ¡å™¨é”™è¯¯: ${o.statusCode}`);{let t=o.data;if("string"==typeof t)try{t=JSON.parse(t)}catch(e){throw console.error("JSONè§£æå¤±è´¥:",e),new Error("æ•°æ®æ ¼å¼é”™è¯¯")}if(!(Array.isArray(t)&&t.length>0))throw new Error("æ•°æ®æ ¼å¼ä¸æ­£ç¡®");a("arknightsData",t),this.localStorage.arknightsData=t,this.characterData=this.validateAndFixData(t),this.applyFilter(),this.calculateStatistics(),s({title:`ç½‘ç»œåŠ è½½æˆåŠŸ (${t.length}ä¸ªç›’å­)`,icon:"success"}),this.emptyText=`å·²åŠ è½½${t.length}ä¸ªç›’å­`}}catch(t){i(),console.error("ç½‘ç»œåŠ è½½å¤±è´¥:",t),this.showNoDataMessage(),this.emptyText="ç½‘ç»œåŠ è½½å¤±è´¥"}},validateAndFixData(e){if(!Array.isArray(e))return console.warn("æ•°æ®ä¸æ˜¯æ•°ç»„ï¼Œè½¬æ¢ä¸ºç©ºæ•°ç»„"),[];const t=[];return e.forEach(((e,a)=>{if(!e||"object"!=typeof e)return void console.warn(`ç´¢å¼•${a}: æ•°æ®é¡¹ä¸ºç©ºæˆ–ä¸æ˜¯å¯¹è±¡`);e.Box_id||(e.Box_id=`æœªçŸ¥${a}`),e.Box_type||(e.Box_type="normal");let s=!1;for(let t=1;t<=10;t++){if(e[`character${t}`]){s=!0;break}}s?t.push(e):console.warn(`ç›’å­${e.Box_id}: æ— è§’è‰²æ•°æ®`)})),console.log(`éªŒè¯ç»“æœ: ${t.length}/${e.length} ä¸ªæœ‰æ•ˆç›’å­`),t},showNoDataMessage(){this.emptyText="è¯·å…ˆè¿”å›åˆ—è¡¨é¡µé¢åŠ è½½æ•°æ®",o({title:"æç¤º",content:"æš‚æ— æ•°æ®ï¼Œè¯·å…ˆè¿”å›åˆ—è¡¨é¡µé¢åŠ è½½æ•°æ®",showCancel:!1,confirmText:"ç¡®å®š",success:e=>{e.confirm}})},forceLoadData(){this.emptyText="æ­£åœ¨å¼ºåˆ¶åŠ è½½æ•°æ®...",this.loadDataFromNetwork()},loadUserData(){try{const e=t("ownedCharacters")||{};this.ownedCharacters=e;const a=t("wantedCharacters")||[];this.wantedCharacters=a;const s=t("tradeCharacters")||{};this.tradeCharacters=s,console.log("ç”¨æˆ·æ•°æ®åŠ è½½å®Œæˆï¼Œå·²ç‚¹äº®è§’è‰²æ•°:",Object.keys(e).length),this.calculateStatistics()}catch(e){console.error("åŠ è½½ç”¨æˆ·æ•°æ®å¤±è´¥:",e)}},saveUserData(){try{a("ownedCharacters",this.ownedCharacters),a("wantedCharacters",this.wantedCharacters),a("tradeCharacters",this.tradeCharacters),console.log("ç”¨æˆ·æ•°æ®ä¿å­˜æˆåŠŸ")}catch(e){console.error("ä¿å­˜ç”¨æˆ·æ•°æ®å¤±è´¥:",e)}},syncWithFavorites(){try{const e=this.localStorage.favoriteCharacterNames||[];if(0===e.length)return void s({title:"æš‚æ— æ”¶è—çš„è§’è‰²",icon:"none"});console.log("ä»æ”¶è—åŒæ­¥ï¼Œæ”¶è—è§’è‰²æ•°:",e.length),e.forEach((e=>{this.ownedCharacters[e]?this.ownedCharacters={...this.ownedCharacters,[e]:{...this.ownedCharacters[e],elite1:!0}}:this.ownedCharacters={...this.ownedCharacters,[e]:{elite1:!0,elite2:!1,boxId:this.findCharacterBox(e)||""}}})),this.saveUserData(),this.calculateStatistics(),s({title:`å·²ä»æ”¶è—åŒæ­¥${e.length}ä¸ªè§’è‰²`,icon:"success"})}catch(e){console.error("åŒæ­¥å¤±è´¥:",e),s({title:"åŒæ­¥å¤±è´¥",icon:"none"})}},findCharacterBox(e){if(!e)return"";for(const t of this.characterData){if(!t)continue;const a=this.getBoxCharacters(t);for(const s of a)if(s&&s.name===e)return t.Box_id||""}return""},getBoxCharacters(e){if(!e||"object"!=typeof e)return console.warn("getBoxCharacters: boxä¸ºç©ºæˆ–ä¸æ˜¯å¯¹è±¡"),[];const t=[];for(let a=1;a<=10;a++){const s=e[`character${a}`];if(!s)continue;let l="",r="",i=!1,o=!1,n=null;if("string"==typeof s){if(l=s.trim(),!l)continue}else{if(!s||"object"!=typeof s)continue;if(l=s.name||"",r=s.imageUrl||s.avatar||"",i=!0===s.nolyELITE1||"true"===s.nolyELITE1,o=!0===s.hotcharacter||"true"===s.hotcharacter,n=s.market_price||null,l||(l=s.characterName||s.CharacterName||""),!l)continue}l=l.trim(),l&&t.push({name:l,avatar:r||this.defaultAvatar,nolyELITE1:i,hotcharacter:o,market_price:n,boxId:e.Box_id||""})}return t},getFilteredCharacters(e){if(!e)return console.warn("getFilteredCharacters: boxä¸ºç©º"),[];const t=this.getBoxCharacters(e);return"all"===this.eliteLevel?t:t.filter((e=>!!e&&("elite1"===this.eliteLevel?e.nolyELITE1||this.isCharacterOwnedAtLevel(e.name,"elite1"):"elite2"!==this.eliteLevel||!e.nolyELITE1&&this.isCharacterOwnedAtLevel(e.name,"elite2"))))},getAllCharactersList(){let e=[];for(const t of this.characterData){if(!t)continue;const a=this.getBoxCharacters(t);e=e.concat(a)}return e},applyFilter(){if(!this.characterData||!Array.isArray(this.characterData))return console.warn("characterDataä¸ºç©ºæˆ–ä¸æ˜¯æ•°ç»„"),this.filteredBoxes=[],void(this.displayBoxes=[]);let e=this.characterData.filter((e=>e&&"object"==typeof e));"all"!==this.currentBoxFilter&&(e=e.filter((e=>{const t=e.Box_type||"normal";return"normal"===this.currentBoxFilter?!t||"normal"===t:t===this.currentBoxFilter}))),this.filteredBoxes=e,this.currentPage=1,this.loadDisplayBoxes(),this.calculateStatistics(),console.log(`ç­›é€‰åç›’å­æ•°: ${e.length}`)},loadDisplayBoxes(){if(!this.filteredBoxes||!Array.isArray(this.filteredBoxes))return this.displayBoxes=[],void(this.hasMore=!1);const e=this.currentPage*this.pageSize;this.displayBoxes=this.filteredBoxes.slice(0,e),this.hasMore=e<this.filteredBoxes.length,console.log(`æ˜¾ç¤ºç›’å­: ${this.displayBoxes.length}, æ€»ç›’å­: ${this.filteredBoxes.length}`)},loadMore(){if(!this.hasMore||!this.filteredBoxes||0===this.filteredBoxes.length)return;this.currentPage++;const e=this.currentPage*this.pageSize;this.displayBoxes=this.filteredBoxes.slice(0,e),this.hasMore=e<this.filteredBoxes.length},onBoxFilterChange(e){const t=parseInt(e.detail.value)||0;this.boxFilterIndex=t,this.applyFilter()},changeMode(e){this.currentMode=e,"trade"===e&&s({title:"å‡ºç‰©æ¨¡å¼ï¼šç‚¹å‡»è§’è‰²æ ‡è®°ä¸ºå¯å‡ºç‰©ï¼Œé•¿æŒ‰æ ‡è®°ä¸ºæƒ³è¦çš„",icon:"none",duration:3e3})},toggleWantMode(){this.wantMode=!this.wantMode,this.wantMode&&s({title:"é•¿æŒ‰è§’è‰²æ ‡è®°ä¸ºæƒ³è¦çš„",icon:"none",duration:2e3})},setEliteLevel(e){this.eliteLevel=e},onAvatarError(e){e&&(e.avatar=this.defaultAvatar)},isCharacterOwned(e){if(!e)return!1;const t=this.ownedCharacters[e];return t&&(t.elite1||t.elite2)},isCharacterOwnedAtLevel(e,t){if(!e)return!1;const a=this.ownedCharacters[e];return!!a&&("elite1"===t?a.elite1:a.elite2)},isCharacterWanted(e){return!!e&&this.wantedCharacters.includes(e)},isCharacterForTrade(e){if(!e)return!1;const t=this.tradeCharacters[e];return t&&(t.elite1||t.elite2)},getTradePrice(e,t){if(!e)return"";const a=this.tradeCharacters[e];return a&&a[t]&&a[t].price||""},setTradePrice(e,t,a){if(!e)return;if(!this.isCharacterOwnedAtLevel(e,t))return void s({title:"è¯·å…ˆç‚¹äº®è§’è‰²çš„"+("elite1"===t?"ç²¾ä¸€":"ç²¾äºŒ"),icon:"none"});const l=parseFloat(a);if(a&&isNaN(l))s({title:"è¯·è¾“å…¥æœ‰æ•ˆçš„ä»·æ ¼",icon:"none"});else{if(this.tradeCharacters={...this.tradeCharacters,[e]:{...this.tradeCharacters[e]||{},[t]:{price:l||0,note:""}}},!l){const a={...this.tradeCharacters};a[e]&&(delete a[e][t],a[e].elite1||a[e].elite2||delete a[e]),this.tradeCharacters=a}this.saveUserData(),this.calculateStatistics()}},toggleCharacterOwnership(e,t){if(!e||!e.name)return void console.warn("è§’è‰²æ•°æ®æ— æ•ˆ");const a=e.name;if(console.log(`åˆ‡æ¢è§’è‰²æ‹¥æœ‰çŠ¶æ€: ${a}`),this.wantMode)this.toggleCharacterWant(a);else if("trade"!==this.currentMode)this.toggleCharacterOwnershipSimple(a,t);else{if(this.isCharacterOwned(a))return;this.toggleCharacterOwnershipSimple(a,t)}},toggleCharacterOwnershipSimple(e,t){if(!e)return;const a=this.ownedCharacters[e];if(a){const s=this.findCharacterByName(e);if(s&&s.nolyELITE1){const t={...this.ownedCharacters};delete t[e],this.ownedCharacters=t}else if(a.elite1&&!a.elite2)this.ownedCharacters={...this.ownedCharacters,[e]:{elite1:!1,elite2:!0,boxId:t||a.boxId}};else if(!a.elite1&&a.elite2){const t={...this.ownedCharacters};delete t[e],this.ownedCharacters=t}else this.ownedCharacters={...this.ownedCharacters,[e]:{elite1:!0,elite2:!1,boxId:t||a.boxId}}}else this.ownedCharacters={...this.ownedCharacters,[e]:{elite1:!0,elite2:!1,boxId:t||""}};this.saveUserData(),this.calculateStatistics(),console.log("å½“å‰æ‹¥æœ‰è§’è‰²:",Object.keys(this.ownedCharacters).length)},findCharacterByName(e){if(!e)return null;for(const t of this.characterData){if(!t)continue;const a=this.getBoxCharacters(t);for(const t of a)if(t&&t.name===e)return t}return null},toggleCharacterWant(e){if(!e)return;const t=this.wantedCharacters.indexOf(e);t>-1?(this.wantedCharacters.splice(t,1),s({title:"å·²å–æ¶ˆæƒ³è¦",icon:"success"})):(this.wantedCharacters.push(e),s({title:"å·²æ ‡è®°ä¸ºæƒ³è¦",icon:"success"})),this.saveUserData(),this.calculateStatistics()},toggleSelectAll(){const e=this.getAllCharactersList();if(this.isAllSelected)this.ownedCharacters={},this.tradeCharacters={},s({title:"å·²å–æ¶ˆå…¨é€‰",icon:"success"});else{const t={};e.forEach((e=>{e&&(t[e.name]={elite1:!0,elite2:!e.nolyELITE1,boxId:e.boxId})})),this.ownedCharacters=t,s({title:`å·²å…¨é€‰${e.length}ä¸ªè§’è‰²`,icon:"success"})}this.saveUserData(),this.calculateStatistics()},isBoxAllSelected(e){if(!e)return!1;const t=this.getBoxCharacters(e);return 0!==t.length&&t.every((e=>e&&this.isCharacterOwned(e.name)))},toggleSelectBox(e){if(!e)return;const t=this.characterData.find((t=>t&&t.Box_id===e));if(!t)return;const a=this.getBoxCharacters(t);if(0===a.length)return void s({title:"è¯¥ç›’å­æ— è§’è‰²",icon:"none"});if(this.isBoxAllSelected(t)){const e={...this.ownedCharacters};a.forEach((t=>{t&&t.name&&e[t.name]&&delete e[t.name]})),this.ownedCharacters=e,s({title:"å·²å–æ¶ˆå…¨é€‰è¯¥ç›’å­",icon:"success"})}else{const t={...this.ownedCharacters};a.forEach((a=>{a&&a.name&&(t[a.name]={elite1:!0,elite2:!a.nolyELITE1,boxId:e})})),this.ownedCharacters=t,s({title:`å·²å…¨é€‰è¯¥ç›’å­${a.length}ä¸ªè§’è‰²`,icon:"success"})}this.saveUserData(),this.calculateStatistics()},selectAllElite1(){const e=this.getAllCharactersList(),t={...this.ownedCharacters};let a=0;e.forEach((e=>{e&&(t[e.name]?t[e.name].elite1||(t[e.name].elite1=!0,a++):(t[e.name]={elite1:!0,elite2:!1,boxId:e.boxId},a++))})),this.ownedCharacters=t,this.saveUserData(),this.calculateStatistics(),s({title:`å·²å…¨é€‰ç²¾ä¸€ (${a}ä¸ª)`,icon:"success"})},selectAllElite2(){const e=this.getAllCharactersList(),t={...this.ownedCharacters};let a=0;e.forEach((e=>{e&&(e.nolyELITE1||(t[e.name]?t[e.name].elite2||(t[e.name].elite2=!0,a++):(t[e.name]={elite1:!1,elite2:!0,boxId:e.boxId},a++)))})),this.ownedCharacters=t,this.saveUserData(),this.calculateStatistics(),s({title:`å·²å…¨é€‰å¯ç²¾äºŒè§’è‰² (${a}ä¸ª)`,icon:"success"})},clearAll(){o({title:"ç¡®è®¤æ¸…ç©º",content:"ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰ç‚¹äº®çŠ¶æ€å—ï¼Ÿ",success:e=>{e.confirm&&(this.ownedCharacters={},this.wantedCharacters=[],this.tradeCharacters={},this.saveUserData(),this.calculateStatistics(),s({title:"å·²æ¸…ç©º",icon:"success"}))}})},calculateStatistics(){this.ownedCount=Object.keys(this.ownedCharacters).length,this.wantedCount=this.wantedCharacters.length,this.tradeCount=Object.keys(this.tradeCharacters).length;const e=new Set;for(const t of this.characterData){if(!t)continue;this.getBoxCharacters(t).forEach((t=>{t&&t.name&&e.add(t.name)}))}this.totalCharacters=e.size,console.log(`ç»Ÿè®¡: æ‹¥æœ‰${this.ownedCount}, æƒ³è¦${this.wantedCount}, å‡ºç‰©${this.tradeCount}, æ€»è®¡${this.totalCharacters}`)},getBoxTypeText(e){if(!e)return"å¸¸è§„æ¬¾";return{whitelist:"ç™½åå•",special:"ç‰¹åˆ«é€šè¡Œ",cooperation:"è”åŠ¨æ¬¾",ambience:"éŸ³å¾‹è”è§‰",normal:"å¸¸è§„æ¬¾"}[e]||"å¸¸è§„æ¬¾"},getBoxTypeClass(e){if(!e)return"type-normal";return{whitelist:"type-whitelist",special:"type-special",cooperation:"type-cooperation",ambience:"type-ambience",normal:"type-normal"}[e]||"type-normal"},debugLocalStorage(){console.log("=== å¼€å§‹è°ƒè¯•æœ¬åœ°å­˜å‚¨ ==="),this.testResult="";try{let e="æœ¬åœ°å­˜å‚¨æ£€æŸ¥ç»“æœ:\n\n";["arknightsData","arknightsDataString","favoriteCharacterNames","enableGuessData","guessData","dataUrl","dataVersion","localUpdateTime","cloudUpdateTime"].forEach((a=>{var s;try{const l=t(a);let r="";if(null==l)r="ç©º";else if(Array.isArray(l)){if(r=`æ•°ç»„[${l.length}]`,l.length>0&&"arknightsData"===a){const e=l[0];r+=`\n  ç¬¬ä¸€ä¸ªç›’å­: ${e.Box_id||"æ— ID"}`,r+=`\n  è§’è‰²1: ${"string"==typeof e.character1?e.character1:(null==(s=e.character1)?void 0:s.name)||"æ— "}`}}else r="object"==typeof l?`å¯¹è±¡ ${JSON.stringify(l).substring(0,50)}...`:"string"==typeof l?`å­—ç¬¦ä¸² "${l.substring(0,50)}${l.length>50?"...":""}"`:String(l);e+=`${a}: ${r}\n`}catch(l){e+=`${a}: è¯»å–å¤±è´¥\n`}})),console.log(e),this.testResult=e,this.showDebugModal=!0}catch(e){console.error("è°ƒè¯•å¤±è´¥:",e),this.testResult=`è°ƒè¯•å¤±è´¥: ${e.message}`}},testCharacterExtraction(){if(console.log("=== æµ‹è¯•è§’è‰²æå– ==="),0===this.characterData.length)return void(this.testResult="æ— è§’è‰²æ•°æ®å¯æµ‹è¯•");let e="è§’è‰²æå–æµ‹è¯•:\n\n";for(let t=0;t<Math.min(3,this.characterData.length);t++){const a=this.characterData[t];e+=`ç›’å­${t+1} (${a.Box_id}):\n`;const s=this.getBoxCharacters(a);e+=`  æå–åˆ° ${s.length} ä¸ªè§’è‰²\n`;for(let t=0;t<Math.min(3,s.length);t++){const a=s[t];e+=`  ${t+1}. ${a.name} (${a.nolyELITE1?"ä»…ç²¾ä¸€":"å¯ç²¾äºŒ"})\n`}e+="\n"}console.log(e),this.testResult=e},clearLocalStorage(){o({title:"ç¡®è®¤æ¸…é™¤",content:"ç¡®å®šè¦æ¸…é™¤æ‰€æœ‰æœ¬åœ°æ•°æ®å—ï¼Ÿ",success:e=>{if(e.confirm)try{["arknightsData","arknightsDataString","favoriteCharacterNames","ownedCharacters","wantedCharacters","tradeCharacters","enableGuessData","guessData"].forEach((e=>{n(e)})),this.characterData=[],this.filteredBoxes=[],this.displayBoxes=[],this.ownedCharacters={},this.wantedCharacters=[],this.tradeCharacters={},this.localStorage={},this.calculateStatistics(),this.emptyText="æ•°æ®å·²æ¸…é™¤ï¼Œè¯·é‡æ–°åŠ è½½",s({title:"æ•°æ®å·²æ¸…é™¤",icon:"success"}),this.showDebugModal=!1}catch(t){console.error("æ¸…é™¤æ•°æ®å¤±è´¥:",t),s({title:"æ¸…é™¤å¤±è´¥",icon:"none"})}}})},reloadData(){this.showDebugModal=!1,this.initData()},closeDebugModal(){this.showDebugModal=!1},openSharePreview(){if(0===this.ownedCount)return void s({title:"è¯·å…ˆç‚¹äº®ä¸€äº›è§’è‰²",icon:"none"});const e=new Date;this.shareGeneratedTime=`${e.getFullYear()}-${(e.getMonth()+1).toString().padStart(2,"0")}-${e.getDate().toString().padStart(2,"0")} ${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}`,this.shareImagePath="",this.showSharePreviewModal=!0},closeSharePreviewModal(){this.showSharePreviewModal=!1,this.shareImagePath=""},getShareBoxes(){return this.characterData.filter((e=>e&&"object"==typeof e))},getShareCharacters(e){if(!e)return console.warn("getShareCharacters: boxä¸ºç©º"),[];return this.getBoxCharacters(e).filter((e=>!(!e||!e.name)&&("show"===this.currentMode?this.isCharacterOwned(e.name):this.isCharacterForTrade(e.name))))},getTotalShareCharacters(){let e=0;for(const t of this.getShareBoxes())e+=this.getShareCharacters(t).length;return e},async generateShareImage(){this.isGeneratingShareImage=!0;try{const t=this.prepareShareData().characters,a=4,l=Math.ceil(t.length/a),r=15,i=90,o=80+l*i+80,n=c("shareCanvas",this),u=375,g=Math.max(o,1e3);n.setFillStyle("#ffffff"),n.fillRect(0,0,u,g),n.setFontSize(18),n.setFillStyle("#333333"),n.setTextAlign("center");const f="show"===this.currentMode?"ğŸŒŸ æˆ‘çš„æ˜æ—¥æ–¹èˆŸæ”¶è— ğŸŒŸ":"ğŸ’¼ å‡ºç‰©æ¸…å• ğŸ’¼";n.fillText(f,u/2,40),n.setFontSize(12),n.setFillStyle("#666666");const C="show"===this.currentMode?"ç‚«è€€æ¨¡å¼ - å±•ç¤ºæˆ‘çš„æ‰€æœ‰æ”¶è—":"å‡ºç‰©æ¨¡å¼ - è¿™äº›è§’è‰²å¯ä»¥äº¤æ˜“";n.fillText(C,u/2,60),n.setStrokeStyle("#e0e0e0"),n.setLineWidth(1),n.moveTo(r,75),n.lineTo(u-r,75),n.stroke(),n.setFontSize(12),n.setTextAlign("left");let m=95;n.setFillStyle("#666666"),n.fillText("å·²ç‚¹äº®è§’è‰²:",r,m),n.setFillStyle("#333333"),n.setTextAlign("right"),n.fillText(`${this.ownedCount}ä¸ª`,u-r,m),n.setTextAlign("left"),m+=20,"trade"===this.currentMode&&this.tradeCount>0&&(n.setFillStyle("#666666"),n.fillText("å‡ºç‰©è§’è‰²:",r,m),n.setFillStyle("#333333"),n.setTextAlign("right"),n.fillText(`${this.tradeCount}ä¸ª`,u-r,m),n.setTextAlign("left"),m+=20),this.shareShowWanted&&this.wantedCount>0&&(n.setFillStyle("#666666"),n.fillText("æƒ³è¦çš„è§’è‰²:",r,m),n.setFillStyle("#FF6B6B"),n.setTextAlign("right"),n.fillText(`${this.wantedCount}ä¸ª`,u-r,m),n.setTextAlign("left"),m+=20),n.setFillStyle("#666666"),n.fillText("ç”Ÿæˆæ—¶é—´:",r,m),n.setFillStyle("#333333"),n.setTextAlign("right"),n.fillText(this.shareGeneratedTime,u-r,m),m+=30,n.setTextAlign("left"),n.setFontSize(15),n.setFillStyle("#333333"),n.fillText("è§’è‰²åˆ—è¡¨",r,m),m+=25;const w=(u-2*r)/a,p=40,_=8;let y=m,x=y;if(t&&t.length>0){for(let e=0;e<t.length;e++){const s=t[e],l=Math.floor(e/a),o=y+l*i;x=o;const c=r+e%a*w+w/2,h=o+_+p/2;n.setFillStyle("#f8fafc"),n.beginPath(),n.arc(c,h,p/2,0,2*Math.PI),n.fill(),n.setFontSize(12),n.setFillStyle("#333333"),n.setTextAlign("center");let d=s.name;d.length>4&&(d=d.substring(0,4));const u=o+p+2*_+12;n.fillText(d,c,u);let g=u+10,f=c-20;if(s.elite1&&(n.setFillStyle("#E6A23C"),n.fillRect(f,g,22,12),n.setFontSize(9),n.setFillStyle("#ffffff"),n.setTextAlign("center"),n.fillText("ç²¾ä¸€",f+11,g+9),f+=25),s.elite2&&!s.nolyELITE1&&(n.setFillStyle("#409EFF"),n.fillRect(f,g,22,12),n.setFontSize(9),n.setFillStyle("#ffffff"),n.setTextAlign("center"),n.fillText("ç²¾äºŒ",f+11,g+9)),this.shareShowPrices){let e=o+i-8;"trade"===this.currentMode&&s.tradePrices?(n.setFontSize(10),n.setFillStyle("#E6A23C"),n.setTextAlign("center"),s.tradePrices.elite1?n.fillText(`${s.tradePrices.elite1}å…ƒ`,c,e):s.tradePrices.elite2&&!s.nolyELITE1&&n.fillText(`${s.tradePrices.elite2}å…ƒ`,c,e)):"show"===this.currentMode&&s.marketPrices&&(n.setFontSize(10),n.setFillStyle("#E6A23C"),n.setTextAlign("center"),s.marketPrices.elite1?n.fillText(`${s.marketPrices.elite1}å…ƒ`,c,e):s.marketPrices.elite2&&!s.nolyELITE1&&n.fillText(`${s.marketPrices.elite2}å…ƒ`,c,e))}this.shareShowWanted&&s.wanted&&(n.setFontSize(14),n.setFillStyle("#FF6B6B"),n.setTextAlign("center"),n.fillText("â¤ï¸",c+15,o+p-8))}x+=i}else n.setFontSize(13),n.setFillStyle("#999999"),n.setTextAlign("center"),n.fillText("show"===this.currentMode?"æš‚æ— ç‚¹äº®è§’è‰²":"æš‚æ— å‡ºç‰©è§’è‰²",u/2,y+30),x=y+60;x+=20,n.setFontSize(10),n.setFillStyle("#999999"),n.setTextAlign("center"),n.fillText(this.watermarkText,u/2,x),x+=20;try{const e=await new Promise(((e,t)=>{h({src:"/static/Searchus.png",success:e,fail:t})})),t=90,a=e.height*t/e.width,s=(u-t)/2,l=x;n.drawImage("/static/Searchus.png",s,l,t,a),x+=a+10}catch(e){console.error("åŠ è½½Searchus.pngå¤±è´¥:",e),n.setFontSize(11),n.setFillStyle("#999999"),n.setTextAlign("center"),n.fillText('å¾®ä¿¡æœç´¢"æ–¹èˆŸé€šè¡Œè¯è°·å­æŸ¥è¯¢å·¥å…·"è·å–æ›´å¤š~',u/2,x),x+=15}n.setFontSize(10),n.setFillStyle("#999999"),n.fillText("é•¿æŒ‰ä¿å­˜å›¾ç‰‡ï¼Œåˆ†äº«ç»™å¥½å‹",u/2,x),await new Promise(((e,t)=>{n.draw(!0,(()=>{setTimeout((()=>{e()}),500)}))})),await new Promise(((e,t)=>{d({canvasId:"shareCanvas",fileType:"png",quality:1,success:t=>{console.log("Canvasç”Ÿæˆå›¾ç‰‡æˆåŠŸ:",t.tempFilePath),this.shareImagePath=t.tempFilePath,e()},fail:e=>{console.error("Canvasç”Ÿæˆå›¾ç‰‡å¤±è´¥:",e),t(e)}},this)})),s({title:"åˆ†äº«å›¾ç”ŸæˆæˆåŠŸ",icon:"success"})}catch(t){console.error("ç”Ÿæˆåˆ†äº«å›¾å¤±è´¥:",t),s({title:"ç”Ÿæˆåˆ†äº«å›¾å¤±è´¥ï¼Œè¯·é‡è¯•",icon:"none"})}finally{this.isGeneratingShareImage=!1}},prepareShareData(){const e=[];for(const t of this.getShareBoxes()){const a=this.getShareCharacters(t);for(const t of a){if(!t||!t.name)continue;const a={name:t.name,elite1:this.isCharacterOwnedAtLevel(t.name,"elite1"),elite2:this.isCharacterOwnedAtLevel(t.name,"elite2"),wanted:this.isCharacterWanted(t.name),nolyELITE1:t.nolyELITE1};"trade"===this.currentMode&&this.isCharacterForTrade(t.name)?a.tradePrices={elite1:this.getTradePrice(t.name,"elite1"),elite2:this.getTradePrice(t.name,"elite2")}:"show"===this.currentMode&&t.market_price&&(a.marketPrices={elite1:t.market_price.ELITE1,elite2:t.market_price.ELITE2}),e.push(a)}}return{characters:e,ownedCount:this.ownedCount,tradeCount:this.tradeCount,wantedCount:this.wantedCount}},previewShareImage(){this.shareImagePath?u({urls:[this.shareImagePath],current:0,success:()=>{console.log("é¢„è§ˆå›¾ç‰‡æˆåŠŸ")},fail:e=>{console.error("é¢„è§ˆå›¾ç‰‡å¤±è´¥:",e),s({title:"é¢„è§ˆå›¾ç‰‡å¤±è´¥",icon:"none"})}}):s({title:"è¯·å…ˆç”Ÿæˆåˆ†äº«å›¾",icon:"none"})},saveShareImage(){this.shareImagePath?g({filePath:this.shareImagePath,success:()=>{s({title:"ä¿å­˜æˆåŠŸ",icon:"success"})},fail:e=>{console.error("ä¿å­˜å¤±è´¥:",e),e.errMsg&&e.errMsg.includes("auth")?o({title:"éœ€è¦æˆæƒ",content:"éœ€è¦ç›¸å†Œæƒé™æ‰èƒ½ä¿å­˜å›¾ç‰‡",success:e=>{e.confirm&&uni.openSetting()}}):s({title:"ä¿å­˜å¤±è´¥ï¼Œè¯·æ£€æŸ¥æƒé™",icon:"none"})}}):s({title:"è¯·å…ˆç”Ÿæˆåˆ†äº«å›¾",icon:"none"})}}},[["render",function(e,t,a,s,l,r){const i=E,o=m,n=D,c=B,h=F,d=M,u=I,g=A,P=L;return w(),f(o,{class:"container"},{default:C((()=>[p(o,{class:"mode-section"},{default:C((()=>[p(o,{class:"mode-tabs"},{default:C((()=>[p(o,{class:_(["mode-tab",{active:"show"===l.currentMode}]),onClick:t[0]||(t[0]=e=>r.changeMode("show"))},{default:C((()=>[p(i,{class:"mode-icon"},{default:C((()=>[y("ğŸŒŸ")])),_:1}),p(i,{class:"mode-text"},{default:C((()=>[y("ç‚«è€€æ¨¡å¼")])),_:1})])),_:1},8,["class"]),p(o,{class:_(["mode-tab",{active:"trade"===l.currentMode}]),onClick:t[1]||(t[1]=e=>r.changeMode("trade"))},{default:C((()=>[p(i,{class:"mode-icon"},{default:C((()=>[y("ğŸ’¼")])),_:1}),p(i,{class:"mode-text"},{default:C((()=>[y("å‡ºç‰©æ¨¡å¼")])),_:1})])),_:1},8,["class"])])),_:1}),p(o,{class:"action-buttons"},{default:C((()=>[p(n,{class:"action-btn select-all-btn",onClick:r.toggleSelectAll},{default:C((()=>[y(x(r.isAllSelected?"å–æ¶ˆå…¨é€‰":"å…¨é€‰ç‚¹äº®"),1)])),_:1},8,["onClick"]),p(n,{class:"action-btn share-btn",onClick:r.openSharePreview,disabled:l.isGeneratingShareImage},{default:C((()=>[y(x(l.isGeneratingShareImage?"ç”Ÿæˆä¸­...":"ç”Ÿæˆåˆ†äº«å›¾"),1)])),_:1},8,["onClick","disabled"]),p(n,{class:_(["action-btn want-btn",{active:l.wantMode}]),onClick:r.toggleWantMode},{default:C((()=>[y(x(l.wantMode?"å–æ¶ˆæƒ³è¦":"æ ‡è®°æƒ³è¦çš„"),1)])),_:1},8,["onClick","class"])])),_:1})])),_:1}),p(o,{class:"filter-stats-section"},{default:C((()=>[p(c,{class:"box-filter-picker",onChange:r.onBoxFilterChange,value:l.boxFilterIndex,range:l.boxFilterOptions},{default:C((()=>[p(o,{class:"picker-text"},{default:C((()=>[y(x(l.boxFilterOptions[l.boxFilterIndex]),1)])),_:1})])),_:1},8,["onChange","value","range"]),p(o,{class:"stats-info"},{default:C((()=>[p(i,{class:"stat-item"},{default:C((()=>[y("ç‚¹äº®: "+x(l.ownedCount)+"/"+x(l.totalCharacters),1)])),_:1}),p(i,{class:"stat-item"},{default:C((()=>[y("æƒ³è¦: "+x(l.wantedCount),1)])),_:1}),p(i,{class:"stat-item"},{default:C((()=>[y("å‡ºç‰©: "+x(l.tradeCount),1)])),_:1})])),_:1})])),_:1}),p(o,{class:"elite-level-selector"},{default:C((()=>[p(o,{class:_(["elite-option",{active:"all"===l.eliteLevel}]),onClick:t[2]||(t[2]=e=>r.setEliteLevel("all"))},{default:C((()=>[p(i,null,{default:C((()=>[y("å…¨éƒ¨")])),_:1})])),_:1},8,["class"]),p(o,{class:_(["elite-option",{active:"elite1"===l.eliteLevel}]),onClick:t[3]||(t[3]=e=>r.setEliteLevel("elite1"))},{default:C((()=>[p(i,{class:"elite-tag elite1-tag"},{default:C((()=>[y("ä»…ç²¾ä¸€")])),_:1})])),_:1},8,["class"]),p(o,{class:_(["elite-option",{active:"elite2"===l.eliteLevel}]),onClick:t[4]||(t[4]=e=>r.setEliteLevel("elite2"))},{default:C((()=>[p(i,{class:"elite-tag elite2-tag"},{default:C((()=>[y("ç²¾äºŒ")])),_:1})])),_:1},8,["class"])])),_:1}),p(u,{class:"boxes-scroll-view","scroll-y":"",onScrolltolower:r.loadMore,"scroll-top":l.scrollTop},{default:C((()=>[(w(!0),v(S,null,b(l.displayBoxes,((e,t)=>(w(),f(o,{class:"box-section",key:(null==e?void 0:e.Box_id)||t},{default:C((()=>[p(o,{class:"box-header"},{default:C((()=>[p(i,{class:"box-title"},{default:C((()=>[y("ç›’å· "+x((null==e?void 0:e.Box_id)||"æœªçŸ¥"),1)])),_:2},1024),p(i,{class:_(["box-type-tag",r.getBoxTypeClass(null==e?void 0:e.Box_type)])},{default:C((()=>[y(x(r.getBoxTypeText(null==e?void 0:e.Box_type)),1)])),_:2},1032,["class"]),p(n,{class:"select-box-btn",onClick:t=>r.toggleSelectBox(null==e?void 0:e.Box_id)},{default:C((()=>[y(x(r.isBoxAllSelected(e)?"å–æ¶ˆå…¨é€‰":"å…¨é€‰ç‚¹äº®"),1)])),_:2},1032,["onClick"])])),_:2},1024),p(o,{class:"characters-grid"},{default:C((()=>[(w(!0),v(S,null,b(r.getFilteredCharacters(e),((t,a)=>(w(),f(o,{class:"character-item",key:a,onClick:a=>r.toggleCharacterOwnership(t,null==e?void 0:e.Box_id),onLongpress:e=>r.toggleCharacterWant(null==t?void 0:t.name)},{default:C((()=>[p(o,{class:"character-avatar-wrapper"},{default:C((()=>[p(h,{class:_(["character-avatar",{owned:r.isCharacterOwned(null==t?void 0:t.name),grayed:!r.isCharacterOwned(null==t?void 0:t.name),wanted:r.isCharacterWanted(null==t?void 0:t.name),"for-trade":r.isCharacterForTrade(null==t?void 0:t.name)}]),src:(null==t?void 0:t.avatar)||l.defaultAvatar,mode:"aspectFit",onError:e=>r.onAvatarError(t)},null,8,["class","src","onError"]),p(o,{class:"status-indicators"},{default:C((()=>[r.isCharacterOwnedAtLevel(null==t?void 0:t.name,"elite1")?(w(),f(o,{key:0,class:"owned-indicator elite1-indicator"},{default:C((()=>[y(" â…  ")])),_:1})):k("",!0),r.isCharacterOwnedAtLevel(null==t?void 0:t.name,"elite2")&&!(null==t?void 0:t.nolyELITE1)?(w(),f(o,{key:1,class:"owned-indicator elite2-indicator"},{default:C((()=>[y(" â…¡ ")])),_:1})):k("",!0),r.isCharacterWanted(null==t?void 0:t.name)?(w(),f(o,{key:2,class:"want-indicator"},{default:C((()=>[y(" â¤ï¸ ")])),_:1})):k("",!0),r.isCharacterForTrade(null==t?void 0:t.name)?(w(),f(o,{key:3,class:"trade-indicator"},{default:C((()=>[y(" ğŸ’¼ ")])),_:1})):k("",!0),(null==t?void 0:t.hotcharacter)?(w(),f(o,{key:4,class:"hot-indicator"},{default:C((()=>[y(" ğŸ”¥ ")])),_:1})):k("",!0)])),_:2},1024),(null==t?void 0:t.market_price)&&"show"===l.currentMode?(w(),f(o,{key:0,class:"price-tags"},{default:C((()=>[t.market_price.ELITE1?(w(),f(i,{key:0,class:"price-tag elite1-tag"},{default:C((()=>[y(x(t.market_price.ELITE1),1)])),_:2},1024)):k("",!0),t.market_price.ELITE2&&!t.nolyELITE1?(w(),f(i,{key:1,class:"price-tag elite2-tag"},{default:C((()=>[y(x(t.market_price.ELITE2),1)])),_:2},1024)):k("",!0)])),_:2},1024)):k("",!0),"trade"===l.currentMode&&r.isCharacterOwned(null==t?void 0:t.name)?(w(),f(o,{key:1,class:"trade-price-inputs"},{default:C((()=>[p(o,{class:"price-input-row"},{default:C((()=>[(null==t?void 0:t.nolyELITE1)?k("",!0):(w(),f(i,{key:0,class:"price-label"},{default:C((()=>[y("ç²¾ä¸€:")])),_:1})),(null==t?void 0:t.nolyELITE1)?k("",!0):(w(),f(d,{key:1,class:"price-input",type:"number",placeholder:r.isCharacterOwnedAtLevel(null==t?void 0:t.name,"elite1")?"å‡ºä»·":"-",disabled:!r.isCharacterOwnedAtLevel(null==t?void 0:t.name,"elite1"),value:r.getTradePrice(null==t?void 0:t.name,"elite1"),onInput:e=>r.setTradePrice(null==t?void 0:t.name,"elite1",e.detail.value)},null,8,["placeholder","disabled","value","onInput"])),(null==t?void 0:t.nolyELITE1)?k("",!0):(w(),f(i,{key:2,class:"price-unit"},{default:C((()=>[y("å…ƒ")])),_:1}))])),_:2},1024),p(o,{class:"price-input-row"},{default:C((()=>[(null==t?void 0:t.nolyELITE1)?k("",!0):(w(),f(i,{key:0,class:"price-label"},{default:C((()=>[y("ç²¾äºŒ:")])),_:1})),(null==t?void 0:t.nolyELITE1)?k("",!0):(w(),f(d,{key:1,class:"price-input",type:"number",placeholder:r.isCharacterOwnedAtLevel(null==t?void 0:t.name,"elite2")?"å‡ºä»·":"-",disabled:!r.isCharacterOwnedAtLevel(null==t?void 0:t.name,"elite2"),value:r.getTradePrice(null==t?void 0:t.name,"elite2"),onInput:e=>r.setTradePrice(null==t?void 0:t.name,"elite2",e.detail.value)},null,8,["placeholder","disabled","value","onInput"])),(null==t?void 0:t.nolyELITE1)?k("",!0):(w(),f(i,{key:2,class:"price-unit"},{default:C((()=>[y("å…ƒ")])),_:1})),(null==t?void 0:t.nolyELITE1)?(w(),f(i,{key:3,class:"only-elite1-tip"},{default:C((()=>[y("ä»…ç²¾ä¸€")])),_:1})):k("",!0)])),_:2},1024)])),_:2},1024)):k("",!0)])),_:2},1024),p(i,{class:"character-name"},{default:C((()=>[y(x((null==t?void 0:t.name)||"æœªçŸ¥è§’è‰²"),1)])),_:2},1024)])),_:2},1032,["onClick","onLongpress"])))),128))])),_:2},1024)])),_:2},1024)))),128)),l.hasMore&&l.filteredBoxes.length>0?(w(),f(o,{key:0,class:"load-more"},{default:C((()=>[p(i,null,{default:C((()=>[y("åŠ è½½æ›´å¤š...")])),_:1})])),_:1})):k("",!0),0===l.displayBoxes.length?(w(),f(o,{key:1,class:"empty-state"},{default:C((()=>[p(h,{class:"empty-icon",src:$}),p(i,{class:"empty-text"},{default:C((()=>[y(x(l.emptyText),1)])),_:1}),p(n,{class:"sync-btn",onClick:r.syncWithFavorites},{default:C((()=>[y(" âœ¨ ä»æ”¶è—åŒæ­¥ ")])),_:1},8,["onClick"]),p(n,{class:"debug-btn",onClick:r.debugLocalStorage},{default:C((()=>[y(" ğŸ” è°ƒè¯•æ•°æ® ")])),_:1},8,["onClick"]),p(n,{class:"load-btn",onClick:r.forceLoadData},{default:C((()=>[y(" ğŸ“¥ å¼ºåˆ¶åŠ è½½æ•°æ® ")])),_:1},8,["onClick"])])),_:1})):k("",!0)])),_:1},8,["onScrolltolower","scroll-top"]),l.showSharePreviewModal?(w(),f(o,{key:0,class:"share-preview-modal",onClick:r.closeSharePreviewModal},{default:C((()=>[p(o,{class:"share-preview-content",onClick:t[7]||(t[7]=T((()=>{}),["stop"]))},{default:C((()=>[p(o,{class:"share-preview-header"},{default:C((()=>[p(i,{class:"share-preview-title"},{default:C((()=>[y("åˆ†äº«å›¾é¢„è§ˆ")])),_:1}),p(n,{class:"share-close-btn",onClick:r.closeSharePreviewModal},{default:C((()=>[y("Ã—")])),_:1},8,["onClick"])])),_:1}),p(o,{class:"share-preview-body"},{default:C((()=>[p(o,{class:"share-content-preview",id:"shareContent"},{default:C((()=>[p(o,{class:"share-header"},{default:C((()=>[p(i,{class:"share-title"},{default:C((()=>[y(x("show"===l.currentMode?"ğŸŒŸ æˆ‘çš„æ˜æ—¥æ–¹èˆŸæ”¶è— ğŸŒŸ":"ğŸ’¼ å‡ºç‰©æ¸…å• ğŸ’¼"),1)])),_:1}),p(i,{class:"share-subtitle"},{default:C((()=>[y(x("show"===l.currentMode?"ç‚«è€€æ¨¡å¼ - å±•ç¤ºæˆ‘çš„æ‰€æœ‰æ”¶è—":"å‡ºç‰©æ¨¡å¼ - è¿™äº›è§’è‰²å¯ä»¥äº¤æ˜“"),1)])),_:1})])),_:1}),p(o,{class:"share-stats"},{default:C((()=>[p(o,{class:"stat-row"},{default:C((()=>[p(i,{class:"stat-label"},{default:C((()=>[y("å·²ç‚¹äº®è§’è‰²:")])),_:1}),p(i,{class:"stat-value"},{default:C((()=>[y(x(l.ownedCount)+"ä¸ª",1)])),_:1})])),_:1}),"trade"===l.currentMode&&l.tradeCount>0?(w(),f(o,{key:0,class:"stat-row"},{default:C((()=>[p(i,{class:"stat-label"},{default:C((()=>[y("å‡ºç‰©è§’è‰²:")])),_:1}),p(i,{class:"stat-value"},{default:C((()=>[y(x(l.tradeCount)+"ä¸ª",1)])),_:1})])),_:1})):k("",!0),l.wantedCount>0?(w(),f(o,{key:1,class:"stat-row"},{default:C((()=>[p(i,{class:"stat-label"},{default:C((()=>[y("æƒ³è¦çš„è§’è‰²:")])),_:1}),p(i,{class:"stat-value wanted-stat"},{default:C((()=>[y(x(l.wantedCount)+"ä¸ª",1)])),_:1})])),_:1})):k("",!0),p(o,{class:"stat-row"},{default:C((()=>[p(i,{class:"stat-label"},{default:C((()=>[y("ç”Ÿæˆæ—¶é—´:")])),_:1}),p(i,{class:"stat-value"},{default:C((()=>[y(x(l.shareGeneratedTime),1)])),_:1})])),_:1})])),_:1}),p(o,{class:"share-divider"}),p(o,{class:"share-characters-section"},{default:C((()=>[p(i,{class:"section-title"},{default:C((()=>[y("è§’è‰²åˆ—è¡¨")])),_:1}),e.box&&r.getShareCharacters(e.box).length>0?(w(!0),v(S,{key:0},b(r.getShareBoxes(),((e,t)=>(w(),f(o,{class:"share-box-section",key:(null==e?void 0:e.Box_id)||t},{default:C((()=>[p(o,{class:"share-box-header"},{default:C((()=>[p(i,{class:"share-box-title"},{default:C((()=>[y("ç›’å· "+x((null==e?void 0:e.Box_id)||"æœªçŸ¥"),1)])),_:2},1024),p(i,{class:_(["share-box-type",r.getBoxTypeClass(null==e?void 0:e.Box_type)])},{default:C((()=>[y(x(r.getBoxTypeText(null==e?void 0:e.Box_type)),1)])),_:2},1032,["class"])])),_:2},1024),p(o,{class:"share-characters-grid"},{default:C((()=>[(w(!0),v(S,null,b(r.getShareCharacters(e),((e,t)=>(w(),f(o,{class:"share-character-item",key:t},{default:C((()=>[p(o,{class:"share-character-content"},{default:C((()=>[p(i,{class:"share-character-name"},{default:C((()=>[y(x((null==e?void 0:e.name)||"æœªçŸ¥è§’è‰²"),1)])),_:2},1024),p(o,{class:"share-level-tags"},{default:C((()=>[r.isCharacterOwnedAtLevel(null==e?void 0:e.name,"elite1")?(w(),f(i,{key:0,class:"level-tag elite1-tag"},{default:C((()=>[y(" ç²¾ä¸€ ")])),_:1})):k("",!0),r.isCharacterOwnedAtLevel(null==e?void 0:e.name,"elite2")&&!(null==e?void 0:e.nolyELITE1)?(w(),f(i,{key:1,class:"level-tag elite2-tag"},{default:C((()=>[y(" ç²¾äºŒ ")])),_:1})):k("",!0)])),_:2},1024),p(o,{class:"share-status-tags"},{default:C((()=>[r.isCharacterWanted(null==e?void 0:e.name)?(w(),f(i,{key:0,class:"status-tag wanted-tag"},{default:C((()=>[y(" â¤ï¸ æƒ³è¦ ")])),_:1})):k("",!0),"trade"===l.currentMode&&r.isCharacterForTrade(null==e?void 0:e.name)?(w(),f(o,{key:1,class:"price-info"},{default:C((()=>[r.getTradePrice(null==e?void 0:e.name,"elite1")?(w(),f(i,{key:0,class:"price-tag"},{default:C((()=>[y(" ç²¾ä¸€: "+x(r.getTradePrice(null==e?void 0:e.name,"elite1"))+"å…ƒ ",1)])),_:2},1024)):k("",!0),r.getTradePrice(null==e?void 0:e.name,"elite2")&&!(null==e?void 0:e.nolyELITE1)?(w(),f(i,{key:1,class:"price-tag"},{default:C((()=>[y(" ç²¾äºŒ: "+x(r.getTradePrice(null==e?void 0:e.name,"elite2"))+"å…ƒ ",1)])),_:2},1024)):k("",!0)])),_:2},1024)):k("",!0),"show"===l.currentMode&&(null==e?void 0:e.market_price)?(w(),f(o,{key:2,class:"price-info"},{default:C((()=>[e.market_price.ELITE1?(w(),f(i,{key:0,class:"price-tag"},{default:C((()=>[y(" å¸‚ä»·: "+x(e.market_price.ELITE1)+"å…ƒ ",1)])),_:2},1024)):k("",!0),e.market_price.ELITE2&&!(null==e?void 0:e.nolyELITE1)?(w(),f(i,{key:1,class:"price-tag"},{default:C((()=>[y(" å¸‚ä»·: "+x(e.market_price.ELITE2)+"å…ƒ ",1)])),_:2},1024)):k("",!0)])),_:2},1024)):k("",!0)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:2},1024)])),_:2},1024)))),128)):k("",!0),0===r.getTotalShareCharacters()?(w(),f(o,{key:1,class:"no-characters"},{default:C((()=>[p(i,{class:"no-characters-text"},{default:C((()=>[y(x("show"===l.currentMode?"æš‚æ— ç‚¹äº®è§’è‰²":"æš‚æ— å‡ºç‰©è§’è‰²"),1)])),_:1})])),_:1})):k("",!0)])),_:1}),l.watermarkText?(w(),f(o,{key:0,class:"share-watermark"},{default:C((()=>[p(i,null,{default:C((()=>[y(x(l.watermarkText),1)])),_:1})])),_:1})):k("",!0),p(o,{class:"share-footer"},{default:C((()=>[p(i,{class:"footer-text"},{default:C((()=>[y("æ–¹èˆŸé€šè¡Œè¯è°·å­æŸ¥è¯¢å·¥å…·")])),_:1}),p(i,{class:"footer-text"},{default:C((()=>[y("é•¿æŒ‰ä¿å­˜å›¾ç‰‡ï¼Œåˆ†äº«ç»™å¥½å‹")])),_:1})])),_:1})])),_:1})])),_:1}),p(o,{class:"share-preview-footer"},{default:C((()=>[p(o,{class:"share-options"},{default:C((()=>[p(o,{class:"option-item"},{default:C((()=>[p(i,{class:"option-label"},{default:C((()=>[y("æ˜¾ç¤ºä»·æ ¼:")])),_:1}),p(g,{checked:l.shareShowPrices,onChange:t[5]||(t[5]=e=>l.shareShowPrices=e.detail.value),color:"#409EFF"},null,8,["checked"])])),_:1}),l.wantedCount>0?(w(),f(o,{key:0,class:"option-item"},{default:C((()=>[p(i,{class:"option-label"},{default:C((()=>[y("æ˜¾ç¤ºæƒ³è¦:")])),_:1}),p(g,{checked:l.shareShowWanted,onChange:t[6]||(t[6]=e=>l.shareShowWanted=e.detail.value),color:"#FF6B6B"},null,8,["checked"])])),_:1})):k("",!0)])),_:1}),p(n,{class:"preview-action-btn capture-btn",onClick:r.generateShareImage,disabled:l.isGeneratingShareImage},{default:C((()=>[y(x(l.isGeneratingShareImage?"ç”Ÿæˆä¸­...":"ğŸ–¼ï¸ ç”Ÿæˆåˆ†äº«å›¾"),1)])),_:1},8,["onClick","disabled"]),l.shareImagePath?(w(),f(o,{key:0,class:"action-buttons-row"},{default:C((()=>[p(h,{src:l.shareImagePath,class:"captured-image-preview",mode:"widthFix",onClick:r.previewShareImage},null,8,["src","onClick"]),p(o,{class:"share-buttons"},{default:C((()=>[p(n,{class:"preview-action-btn save-btn",onClick:r.saveShareImage},{default:C((()=>[y(" ğŸ’¾ ä¿å­˜å›¾ç‰‡ ")])),_:1},8,["onClick"])])),_:1})])),_:1})):k("",!0)])),_:1})])),_:1})])),_:1},8,["onClick"])):k("",!0),p(P,{"canvas-id":"shareCanvas",style:{position:"absolute",left:"-9999px",top:"-9999px",width:"750rpx",height:"1334rpx"},id:"shareCanvas"}),p(o,{class:"bottom-action-bar"},{default:C((()=>[p(o,{class:"quick-actions"},{default:C((()=>[p(n,{class:"quick-btn",onClick:r.selectAllElite1},{default:C((()=>[p(i,null,{default:C((()=>[y("å…¨é€‰ç²¾ä¸€")])),_:1})])),_:1},8,["onClick"]),p(n,{class:"quick-btn",onClick:r.selectAllElite2},{default:C((()=>[p(i,null,{default:C((()=>[y("å…¨é€‰ç²¾äºŒ")])),_:1})])),_:1},8,["onClick"]),p(n,{class:"quick-btn",onClick:r.clearAll},{default:C((()=>[p(i,null,{default:C((()=>[y("æ¸…ç©ºæ‰€æœ‰")])),_:1})])),_:1},8,["onClick"])])),_:1}),p(o,{class:"summary-info"},{default:C((()=>[p(i,{class:"summary-text"},{default:C((()=>[y("å·²ç‚¹äº®: "+x(l.ownedCount)+" | æƒ³è¦: "+x(l.wantedCount),1)])),_:1})])),_:1})])),_:1}),l.showDebugModal?(w(),f(o,{key:1,class:"debug-modal",onClick:r.closeDebugModal},{default:C((()=>[p(o,{class:"debug-modal-content",onClick:t[8]||(t[8]=T((()=>{}),["stop"]))},{default:C((()=>[p(o,{class:"debug-modal-header"},{default:C((()=>[p(i,{class:"debug-modal-title"},{default:C((()=>[y("è°ƒè¯•ä¿¡æ¯")])),_:1}),p(n,{class:"debug-close-btn",onClick:r.closeDebugModal},{default:C((()=>[y("Ã—")])),_:1},8,["onClick"])])),_:1}),p(u,{class:"debug-body","scroll-y":""},{default:C((()=>[p(o,{class:"debug-section"},{default:C((()=>[p(i,{class:"debug-section-title"},{default:C((()=>[y("æ•°æ®çŠ¶æ€")])),_:1}),p(o,{class:"debug-item"},{default:C((()=>[p(i,{class:"debug-label"},{default:C((()=>[y("è§’è‰²æ•°æ®é•¿åº¦:")])),_:1}),p(i,{class:"debug-value"},{default:C((()=>[y(x(l.characterData.length),1)])),_:1})])),_:1}),p(o,{class:"debug-item"},{default:C((()=>[p(i,{class:"debug-label"},{default:C((()=>[y("è¿‡æ»¤åç›’å­æ•°:")])),_:1}),p(i,{class:"debug-value"},{default:C((()=>[y(x(l.filteredBoxes.length),1)])),_:1})])),_:1}),p(o,{class:"debug-item"},{default:C((()=>[p(i,{class:"debug-label"},{default:C((()=>[y("æ˜¾ç¤ºç›’å­æ•°:")])),_:1}),p(i,{class:"debug-value"},{default:C((()=>[y(x(l.displayBoxes.length),1)])),_:1})])),_:1}),p(o,{class:"debug-item"},{default:C((()=>[p(i,{class:"debug-label"},{default:C((()=>[y("ç©ºçŠ¶æ€æ–‡æœ¬:")])),_:1}),p(i,{class:"debug-value"},{default:C((()=>[y(x(l.emptyText),1)])),_:1})])),_:1})])),_:1}),p(o,{class:"debug-section"},{default:C((()=>[p(i,{class:"debug-section-title"},{default:C((()=>[y("ç”¨æˆ·æ•°æ®")])),_:1}),p(o,{class:"debug-item"},{default:C((()=>[p(i,{class:"debug-label"},{default:C((()=>[y("å·²ç‚¹äº®è§’è‰²:")])),_:1}),p(i,{class:"debug-value"},{default:C((()=>[y(x(l.ownedCount)+"ä¸ª",1)])),_:1})])),_:1}),p(o,{class:"debug-item"},{default:C((()=>[p(i,{class:"debug-label"},{default:C((()=>[y("æƒ³è¦çš„è§’è‰²:")])),_:1}),p(i,{class:"debug-value"},{default:C((()=>[y(x(l.wantedCount)+"ä¸ª",1)])),_:1})])),_:1}),p(o,{class:"debug-item"},{default:C((()=>[p(i,{class:"debug-label"},{default:C((()=>[y("å‡ºç‰©è§’è‰²:")])),_:1}),p(i,{class:"debug-value"},{default:C((()=>[y(x(l.tradeCount)+"ä¸ª",1)])),_:1})])),_:1})])),_:1}),p(o,{class:"debug-section"},{default:C((()=>[p(i,{class:"debug-section-title"},{default:C((()=>[y("æœ¬åœ°å­˜å‚¨")])),_:1}),p(o,{class:"debug-item"},{default:C((()=>[p(i,{class:"debug-label"},{default:C((()=>[y("arknightsData:")])),_:1}),p(i,{class:"debug-value"},{default:C((()=>[y(x(l.localStorage.arknightsData?"å­˜åœ¨":"ä¸å­˜åœ¨"),1)])),_:1})])),_:1}),p(o,{class:"debug-item"},{default:C((()=>[p(i,{class:"debug-label"},{default:C((()=>[y("arknightsDataString:")])),_:1}),p(i,{class:"debug-value"},{default:C((()=>[y(x(l.localStorage.arknightsDataString?"å­˜åœ¨":"ä¸å­˜åœ¨"),1)])),_:1})])),_:1}),p(o,{class:"debug-item"},{default:C((()=>[p(i,{class:"debug-label"},{default:C((()=>[y("favoriteCharacterNames:")])),_:1}),p(i,{class:"debug-value"},{default:C((()=>[y(x(l.localStorage.favoriteCharacterNames?`${l.localStorage.favoriteCharacterNames.length}ä¸ª`:"ä¸å­˜åœ¨"),1)])),_:1})])),_:1})])),_:1}),p(o,{class:"debug-section"},{default:C((()=>[p(i,{class:"debug-section-title"},{default:C((()=>[y("è§’è‰²è·å–æµ‹è¯•")])),_:1}),p(n,{class:"test-btn",onClick:r.testCharacterExtraction},{default:C((()=>[y(" æµ‹è¯•è§’è‰²æå– ")])),_:1},8,["onClick"]),l.testResult?(w(),f(o,{key:0,class:"test-result"},{default:C((()=>[p(i,{class:"test-result-text"},{default:C((()=>[y(x(l.testResult),1)])),_:1})])),_:1})):k("",!0)])),_:1})])),_:1}),p(o,{class:"debug-modal-footer"},{default:C((()=>[p(n,{class:"debug-action-btn",onClick:r.clearLocalStorage},{default:C((()=>[y(" ğŸ—‘ï¸ æ¸…é™¤æ‰€æœ‰æ•°æ® ")])),_:1},8,["onClick"]),p(n,{class:"debug-action-btn",onClick:r.reloadData},{default:C((()=>[y(" ğŸ”„ é‡æ–°åŠ è½½ ")])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1},8,["onClick"])):k("",!0)])),_:1})}],["__scopeId","data-v-a066a90e"]]);export{O as default};
