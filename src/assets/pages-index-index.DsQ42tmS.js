import{g as t,s as e,r as o,a as s,b as i,c as a,h as n,d as l,e as c,f as r,n as d,i as h,j as g,k as u,v as p,l as m,m as f,w as C,o as T,p as A,q as w,t as k,u as U,x as y,y as x,z as b,A as S,B as E,F as N,C as M,D as v,E as I,S as D,G as j,H as R}from"./index-BAWL4vNb.js";import{r as P,_ as L}from"./uni-notice-bar.oGO20K9w.js";import{_ as G}from"./notice-icon.BKHgi8_o.js";import{_}from"./right.Urk-vgEs.js";import{_ as H}from"./_plugin-vue_export-helper.BCo6x5W8.js";const O=""+new URL("Setting-tool-Cfd6Z1L9.png",import.meta.url).href,B=""+new URL("new-Bpp0l5NA.png",import.meta.url).href,J=()=>(console.log("当前是 H5 环境，使用代理前缀 /api"),"/api"),V={clientId:"21680db9b1362913357c",tableNames:{choearth_notice:"choearth_notice",more_notice:"more_notice",Version:"Version",AiToolsConfig:"AiToolsConfig"}};const z=H({data:()=>({noticeContent:"",noticeExpanded:!1,noticeOverflow:!1,showNotice:!0,noticeSectionExpanded:!0,characterData:[],dataStatusMessage:"",cloudUpdateTime:"",localUpdateTime:"",currentVersion:"",dataUrl:"",latestVersion:"",moreNoticeContent:"",moreNoticeId:"",carouselImages:[],noticeClosedUntilUpdate:!1,isRefreshing:!1,toolsConfig:[],tempToolsConfig:[],editingTools:[],isEditingTools:!1,showLongPressHint:!1,longPressTimer:null,isLongPressing:!1,retryCount:0,hasUpdate:!1,autoUpdateEnabled:!1,autoUpdateConfig:{enabled:!1,checkInterval:864e5,wifiOnly:!0,autoDownload:!1},lastAutoUpdateCheckTime:"",nextAutoUpdateTime:"",showAutoUpdateStatus:!1,autoUpdateStatusMessage:"",autoUpdateStatusClass:"",showAutoUpdatePrompt:!1,autoUpdatePromptMessage:"",isCheckingUpdate:!1,isDownloading:!1,easterEggs:[],showEasterEgg:!1,easterEggText:"",copyrightClickCount:0,originalCopyrightTexts:["方舟通行证谷子查询工具","本工具为玩家自制，与官方无关"]}),onPullDownRefresh(){this.handleRefresh()},onLoad(){console.log("首页加载，开始初始化数据..."),this.loadLocalData(),this.fetchNotice(),this.fetchMoreNotice(),this.fetchCarouselImages(),this.initDefaultToolsConfig(),this.loadAutoUpdateSetting(),this.initEasterEggs(),this.initDefaultToolsConfig(),this.loadAiToolsConfig();const o=t("copyrightClickCount");o&&(this.copyrightClickCount=o);const s=t("noticeClosed"),i=t("noticeClosedUntilUpdate");s&&(this.showNotice=!1),i&&(this.noticeClosedUntilUpdate=i);const a=t("noticeSectionExpanded");null!=a&&(this.noticeSectionExpanded=a,this.noticeSectionExpanded&&this.$nextTick((()=>{setTimeout((()=>{this.checkNoticeOverflow()}),500)}))),uni.showShareMenu({withShareTicket:!0,menus:["shareAppMessage","shareTimeline"]});t("hasShownLongPressHint")||setTimeout((()=>{this.showLongPressHint=!0,setTimeout((()=>{this.showLongPressHint=!1,e("hasShownLongPressHint",!0)}),3e3)}),2e3)},onShareAppMessage:()=>({title:"方舟通行证谷子查询工具",path:"/pages/index/index",imageUrl:""}),onShareTimeline:()=>({title:"方舟通行证谷子查询工具",imageUrl:""}),onReady(){this.$nextTick((()=>{setTimeout((()=>{this.checkNoticeOverflow()}),500)}))},methods:{async knowCloudRequest(t,e={},s=0){if(s>3)throw console.error("知晓云请求重试次数过多"),new Error("知晓云请求重试次数过多");try{const s=V.tableNames[t];if(!s)throw new Error(`未找到表 ${t} 的配置`);const i={url:`${J()}/table/${s}/record/`,method:"GET",header:{"X-Hydrogen-Client-ID":V.clientId,"Content-Type":"application/json"},timeout:15e3},a={...i,...e};if(e.data){const t=new URLSearchParams;Object.keys(e.data).forEach((o=>{t.append(o,e.data[o])})),a.url=`${i.url}?${t.toString()}`}console.log("发送知晓云请求:",a.url);const n=await o(a);if(console.log("知晓云响应状态:",n.statusCode),200===n.statusCode)return n.data;throw console.error("知晓云请求错误:",n.statusCode,n.data),new Error(`请求失败: ${n.statusCode}`)}catch(i){if(console.error(`知晓云请求失败 (${t}):`,i),s<3)return console.log(`第${s+1}次重试...`),await this.knowCloudRequest(t,e,s+1);throw i}},toggleToolManagement(){this.isEditingTools?this.saveToolsConfig():this.startEditingMode()},async fetchAiToolsConfig(){try{const t=await o({url:`${J()}/table/AiToolsConfig/record/?limit=1`,method:"GET",header:{"X-Hydrogen-Client-ID":V.clientId,"Content-Type":"application/json"},timeout:1e4});if(200===t.statusCode&&t.data&&t.data.objects&&t.data.objects.length>0){return!0===t.data.objects[0].Enabled}return!1}catch(t){return console.error("获取 AI 工具配置失败",t),!1}},async loadAiToolsConfig(){const t=await this.fetchAiToolsConfig(),o=this.toolsConfig.findIndex((t=>"questionnaire"===t.id));if(-1!==o){const s=this.toolsConfig[o];t?(s.name="AI帮查",s.icon="/static/aisearch-icon.png",s.url="/pages/Ai_Search/Ai_Search",s.specialAction=""):(s.name="前往元宝小程序帮查>",s.icon="/static/search-icon.png",s.url="",s.specialAction="gotoaitools"),this.toolsConfig=[...this.toolsConfig],e("toolsConfig",this.toolsConfig)}},handleRefresh(){this.isRefreshing||(this.isRefreshing=!0,console.log("开始下拉刷新"),s({title:"刷新中..."}),Promise.all([this.fetchNotice(),this.fetchMoreNotice(),this.fetchCarouselImages(),this.checkForDataUpdates(!0,!1)]).then((()=>{i({title:"刷新成功",icon:"success",duration:1500})})).catch((t=>{console.error("刷新失败:",t),i({title:"刷新失败",icon:"none",duration:2e3})})).finally((()=>{a(),n(),this.isRefreshing=!1})))},toggleNoticeSection(){this.noticeSectionExpanded=!this.noticeSectionExpanded,e("noticeSectionExpanded",this.noticeSectionExpanded),this.noticeSectionExpanded&&this.$nextTick((()=>{setTimeout((()=>{this.checkNoticeOverflow()}),300)}))},closeNotice(){console.log("关闭按钮被点击"),l({title:"关闭公告",content:"是否在公告下次更新前保持关闭？",confirmText:"本次关闭",cancelText:"保持关闭",success:t=>{console.log("用户选择:",t.confirm?"仅本次关闭":"保持关闭"),t.confirm?(this.noticeClosedUntilUpdate=!0,e("noticeClosedUntilUpdate",!0),this.showNotice=!1,e("noticeClosed",!0),console.log("公告已关闭，仅本次")):t.cancel&&(this.showNotice=!1,e("noticeClosed",!0),console.log("公告已关闭，直到下次更新"))},fail:t=>{console.error("显示确认对话框失败:",t),this.showNotice=!1,e("noticeClosed",!0)}})},checkNoticeOverflow(){c().in(this).select(".notice-text").boundingClientRect((t=>{if(t){const e=3*(14*1.6);this.noticeOverflow=t.height>e,console.log("公告高度:",t.height,"阈值:",e,"需要折叠:",this.noticeOverflow),this.noticeOverflow||(this.noticeExpanded=!0)}})).exec()},toggleNoticeExpand(){this.noticeExpanded=!this.noticeExpanded},async fetchCarouselImages(){try{const t=await this.knowCloudRequest("choearth_notice",{data:{limit:10,offset:0}});if(console.log("轮播图API响应:",t),t&&t.objects&&t.objects.length>0){console.log("原始轮播图数据:",t.objects);const e=t.objects.filter((t=>{const e=t.imageurl||t.imageUrl;return console.log("检查图片项:",t,"是否有图片:",e),e})).map((t=>{const e={imageUrl:t.imageurl||t.imageUrl||"",linkUrl:t.linkUrl||"",title:t.title||"",id:t.id||""};return console.log("映射后的图片数据:",e),e}));console.log("处理后的轮播图数据:",e),this.carouselImages=[...e],console.log("最终carouselImages:",this.carouselImages)}else console.log("未找到轮播图数据或数据格式不正确")}catch(t){console.error("获取轮播图数据失败:",t),this.carouselImages=[]}},onCarouselItemClick(t){r({data:"https://mingrifangzhou.tmall.com/",success:()=>{i({title:"链接复制成功",icon:"success"})},fail:t=>{console.error("复制链接失败:",t),i({title:"复制失败，请手动复制链接",icon:"none"})}})},gotoquestionnaire(){uni.openEmbeddedMiniProgram({appId:"wxebadf544ddae62cb",path:"pages/webview/index?sid=25648071&hash=skl8&navigateBackMiniProgram=true"})},gotoaitools(){uni.openEmbeddedMiniProgram({appId:"wxd5201eb08d2fa15c",path:"pages/agentChat/index?showAuthDirectly=1&agentId=0aRyBMBEs8rL"})},async fetchMoreNotice(){try{console.log("开始获取更多公告...");const t=await o({url:"https://21680db9b1362913357c.myminapp.com/hserve/v2.2/table/more_notice/record/?limit=1&offset=0&order_by=-created_at",method:"GET",header:{"X-Hydrogen-Client-ID":"21680db9b1362913357c","Content-Type":"application/json"},timeout:1e4});if(console.log("获取更多公告响应:",t),200===t.statusCode&&t.data&&t.data.objects&&t.data.objects.length>0){const e=t.data.objects[0];this.moreNoticeContent=e.content||"",this.moreNoticeId=e.id||"",console.log("获取更多公告成功:",this.moreNoticeContent),this.updateScrollNotice()}else console.log("未找到公告数据或数据格式不正确"),this.moreNoticeContent="当前外号、英文名搜索及烫度标记、仅精一显示均为内测阶段，如有显示异常，可在小程序首页->关于我们->问题反馈中提交问卷，也可以在右上角联系客服解决，感谢您的理解与支持！",this.moreNoticeId=""}catch(t){console.error("获取更多公告失败:",t),this.moreNoticeContent="当前外号、英文名搜索及烫度标记、仅精一显示均为内测阶段，如有显示异常，可在小程序首页->关于我们->问题反馈中提交问卷，也可以在右上角联系客服解决，感谢您的理解与支持！",this.moreNoticeId=""}},gotoMoreNotice(){this.moreNoticeId?d({url:`/packageA/more-notice/more-notice?id=${this.moreNoticeId}`}):d({url:"/packageA/more-notice/more-notice"})},async fetchCarouselImages(){try{console.log("开始获取轮播图数据...");const s=await o({url:"https://21680db9b1362913357c.myminapp.com/hserve/v2.2/table/choearth_notice/record/?limit=10&offset=0",method:"GET",header:{"X-Hydrogen-Client-ID":"21680db9b1362913357c","Content-Type":"application/json"},timeout:1e4});if(console.log("轮播图API响应:",s),200===s.statusCode&&s.data&&s.data.objects){console.log("原始轮播图数据:",s.data.objects);const t=s.data.objects.filter((t=>{const e=t.imageurl||t.imageUrl;return console.log("检查图片项:",t,"是否有图片:",e),e})).map((t=>{const e={imageUrl:t.imageurl||t.imageUrl||"",linkUrl:t.linkUrl||"",title:t.title||"",id:t.id||""};return console.log("映射后的图片数据:",e),e}));console.log("处理后的轮播图数据:",t),this.carouselImages=[...t],console.log("最终carouselImages:",this.carouselImages),t.length>0&&e("carouselImages",t)}else{console.log("未找到轮播图数据或数据格式不正确");const e=t("carouselImages");e&&e.length>0&&(this.carouselImages=e)}}catch(s){console.error("获取轮播图数据失败:",s);const e=t("carouselImages");e&&e.length>0&&(this.carouselImages=e)}},async fetchNotice(){try{console.log("开始获取公告内容...");const t=await o({url:"https://21680db9b1362913357c.myminapp.com/hserve/v2.2/table/Version/record/?limit=1&offset=0",method:"GET",header:{"X-Hydrogen-Client-ID":"21680db9b1362913357c","Content-Type":"application/json"},timeout:1e4});if(console.log("公告API响应:",t),200===t.statusCode&&t.data&&t.data.objects&&t.data.objects.length>0){const e=t.data.objects[0].notice||"";this.noticeClosedUntilUpdate&&this.noticeContent!==e&&(this.noticeClosedUntilUpdate=!1,this.showNotice=!0,h("noticeClosedUntilUpdate"),h("noticeClosed")),this.noticeContent=e,console.log("获取公告成功:",this.noticeContent),this.$nextTick((()=>{setTimeout((()=>{this.checkNoticeOverflow()}),300)}))}else console.error("获取公告失败: 数据格式不正确")}catch(t){console.error("获取公告失败:",t)}},updateScrollNotice(){this.moreNoticeContent&&console.log("滚动公告栏内容已更新:",this.moreNoticeContent)},navigateTo(t){d({url:t})},formatCloudTime(t){if(!t)return"";try{let e;if("number"!=typeof t&&!/^\d+$/.test(t)||10!==t.toString().length&&13!==t.toString().length)e=new Date(t);else{const o=parseInt(t);e=10===o.toString().length?new Date(1e3*o):new Date(o)}return isNaN(e.getTime())?(console.warn("无效的时间格式:",t),"未知时间"):`${e.getFullYear()}-${(e.getMonth()+1).toString().padStart(2,"0")}-${e.getDate().toString().padStart(2,"0")} ${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}`}catch(e){return console.error("格式化云端时间失败:",e,"原始时间:",t),"string"==typeof t?t:"时间格式错误"}},async loadLocalData(){try{const e=t("arknightsData"),o=t("localUpdateTime"),s=t("cloudUpdateTime"),i=t("dataVersion"),a=t("dataUrl"),n=t("enableGuessData"),l=t("guessData");let c=[];e&&Array.isArray(e)&&e.length>0&&(c=[...e],this.dataStatusMessage=`已加载本地数据 (${e.length} 个盒号)`),"true"===n&&l&&Array.isArray(l)&&l.length>0&&(c=[...c,...l],this.dataStatusMessage+=` + 预测数据 (${l.length} 个盒号)`),c.length>0?(this.characterData=c,this.localUpdateTime=o||"",this.cloudUpdateTime=s||"",this.currentVersion=i||"",this.dataUrl=a||"",this.checkForDataUpdates(!1,!1)):(this.dataStatusMessage="正在获取数据信息...",setTimeout((()=>{this.checkForDataUpdates(!1,!1)}),2e3))}catch(e){console.error("加载本地数据失败:",e),this.dataStatusMessage="加载本地数据失败，正在尝试获取最新数据...",setTimeout((()=>{this.checkForDataUpdates(!1,!1)}),2e3)}},async getDataUrlFromMinapp(){try{const t=await this.knowCloudRequest("Version");if(console.log("知晓云版本信息响应:",t),t&&t.objects&&t.objects.length>0){const e=t.objects[0];console.log("版本数据:",e);let o=e.updated_at||e.created_at||"";return{url:e.url||"",version:e.version||e.Version||"",cloudUpdateTime:o}}throw console.error("知晓云返回数据格式不正确:",t),new Error("未找到版本数据或数据格式不正确")}catch(t){throw console.error("从知晓云获取URL失败:",t),t}},async update(){i({title:"敬请期待...",icon:"error"})},loadAutoUpdateSetting(){try{const e=t("autoUpdateSetting");console.log("Index页面加载自动更新设置:",e),e?(this.autoUpdateEnabled=e.enabled||!1,this.autoUpdateConfig=e,this.lastAutoUpdateCheckTime=e.lastCheckTime||"",this.showAutoUpdateStatus=this.autoUpdateEnabled,this.autoUpdateEnabled?(this.autoUpdateStatusMessage="自动更新已开启",this.autoUpdateStatusClass="status-success",this.calculateNextUpdateTime(),console.log("Index页面: 自动更新已开启"),setTimeout((()=>{this.checkAndPerformAutoUpdate()}),3e3)):(this.autoUpdateStatusMessage="自动更新已关闭",this.autoUpdateStatusClass="status-error",console.log("Index页面: 自动更新已关闭"))):(console.log("Index页面: 未找到自动更新设置"),this.autoUpdateEnabled=!1,this.autoUpdateStatusMessage="自动更新未配置")}catch(e){console.error("Index页面加载自动更新设置失败:",e),this.autoUpdateEnabled=!1}},calculateNextUpdateTime(){if(this.lastAutoUpdateCheckTime)try{const t=new Date(this.lastAutoUpdateCheckTime).getTime()+this.autoUpdateConfig.checkInterval,e=(new Date).getTime();if(e>=t)this.nextAutoUpdateTime="立即";else{const o=t-e,s=Math.floor(o/36e5),i=Math.floor(o%36e5/6e4);this.nextAutoUpdateTime=s>0?`${s}小时${i}分钟后`:`${i}分钟后`}}catch(t){console.error("计算下次检查时间失败:",t),this.nextAutoUpdateTime="未知"}else this.nextAutoUpdateTime="待检查"},async checkAndPerformAutoUpdate(){try{const o=t("autoUpdateSetting");if(!((null==o?void 0:o.enabled)||!1))return;const s=t("dataSource")||"domestic";if("domestic"!==s&&"local"!==s)return void console.log("当前数据源不支持自动更新");const i=o.lastCheckTime,a=(new Date).getTime();let n=!0;if(i){const t=new Date(i).getTime();n=a-t>=(o.checkInterval||864e5)}if(n){console.log("执行自动更新检查");const t="wifi"===await this.getNetworkType();if(o.wifiOnly&&!t)return console.log("当前为移动网络，跳过自动更新检查"),o.lastCheckTime=(new Date).toISOString(),e("autoUpdateSetting",o),this.lastAutoUpdateCheckTime=this.formatLocalTime(new Date),this.autoUpdateStatusMessage="当前为移动网络，跳过检查",this.autoUpdateStatusClass="status-warning",void this.calculateNextUpdateTime();await this.checkForDataUpdates(!0,!0)}}catch(o){console.error("检查自动更新失败:",o)}},getNetworkType:()=>new Promise(((t,e)=>{g({success:e=>{t(e.networkType)},fail:e=>{console.error("获取网络类型失败:",e),t("unknown")}})})),async checkForDataUpdates(o=!1,s=!1){console.log("检查数据更新，强制检查:",o,"自动更新:",s),s&&(this.isCheckingUpdate=!0,this.autoUpdateStatusMessage="正在检查更新...",this.autoUpdateStatusClass="status-loading");try{const a=await this.getDataUrlFromMinapp();if(a){this.dataUrl=a.url,this.latestVersion=a.version,this.cloudUpdateTime=a.cloudUpdateTime||this.cloudUpdateTime;const n=await this.checkVersionUpdate(a.version);if(this.hasUpdate=n,s){const o=t("autoUpdateSetting");if(o.lastCheckTime=(new Date).toISOString(),e("autoUpdateSetting",o),this.lastAutoUpdateCheckTime=this.formatLocalTime(new Date),this.calculateNextUpdateTime(),n){const t="wifi"===await this.getNetworkType();o.autoDownload||t?(this.autoUpdateStatusMessage="发现更新，正在自动下载...",this.autoUpdateStatusClass="status-loading",await this.performAutoUpdate()):(this.showAutoUpdatePrompt=!0,this.autoUpdatePromptMessage="检测到新版本数据，当前为移动网络，是否立即下载更新？",this.autoUpdateStatusMessage="发现更新，等待用户确认",this.autoUpdateStatusClass="status-warning")}else this.autoUpdateStatusMessage="数据已是最新版本",this.autoUpdateStatusClass="status-success"}else n?(this.autoUpdateEnabled||console.log("自动更新关闭，有更新，显示更新提示"),o&&l({title:"发现更新",content:`发现新版本数据 (${a.version})，是否立即更新？`,confirmText:"立即更新",cancelText:"稍后",success:t=>{t.confirm&&this.downloadData()}})):o&&i({title:"当前已是最新版本",icon:"success",duration:2e3})}}catch(a){console.error("检查数据更新失败:",a),s?(this.autoUpdateStatusMessage="检查更新失败",this.autoUpdateStatusClass="status-error"):o&&i({title:"检查更新失败，请重试",icon:"none"})}finally{s&&(this.isCheckingUpdate=!1,this.autoUpdateStatusMessage.includes("发现更新")||setTimeout((()=>{this.autoUpdateStatusMessage=""}),3e3))}},async checkVersionUpdate(e){try{const o=t("dataVersion")||"";if(console.log("版本检查:",{localVersion:o,cloudVersion:e,areEqual:o===e}),o&&e)return o!==e;if(!o&&e)return!0;const s=t("arknightsData");return!s||0===s.length}catch(o){return console.error("检查版本更新失败:",o),!1}},async performAutoUpdate(){try{await this.downloadData(),this.autoUpdateStatusMessage="数据更新成功",this.autoUpdateStatusClass="status-success",setTimeout((()=>{this.autoUpdateStatusMessage=""}),3e3)}catch(t){console.error("执行自动更新失败:",t),this.autoUpdateStatusMessage="自动更新失败",this.autoUpdateStatusClass="status-error"}},manualCheckUpdate(){this.isCheckingUpdate||this.isDownloading?i({title:"正在处理中，请稍候",icon:"none"}):this.checkForDataUpdates(!0,!1)},cancelAutoUpdate(){this.showAutoUpdatePrompt=!1,this.autoUpdatePromptMessage="",this.autoUpdateStatusMessage="更新已取消",this.autoUpdateStatusClass="status-error",setTimeout((()=>{this.autoUpdateStatusMessage=""}),3e3)},confirmAutoUpdate(){this.showAutoUpdatePrompt=!1,this.performAutoUpdate()},formatLocalTime(t){if(!t)return"";try{const e=t instanceof Date?t:new Date(t);return isNaN(e.getTime())?"无效时间":`${e.getFullYear()}-${(e.getMonth()+1).toString().padStart(2,"0")}-${e.getDate().toString().padStart(2,"0")} ${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}`}catch(e){return console.error("格式化本地时间失败:",e),"时间格式错误"}},cleanupAutoUpdateTimer(){this.autoUpdateTimer&&(clearInterval(this.autoUpdateTimer),this.autoUpdateTimer=null)},async downloadData(){if(this.dataUrl&&this.dataUrl.includes("raw.gitcode.com")&&(this.dataUrl=this.dataUrl.replace("https://raw.gitcode.com","/gitcode")),!this.latestVersion)try{const t=await this.getDataUrlFromMinapp();this.dataUrl=t.url,this.latestVersion=t.version,this.cloudUpdateTime=t.cloudUpdateTime||this.cloudUpdateTime}catch(t){console.error("获取数据URL失败:",t),this.dataUrl="https://raw.gitcode.com/huangjinzhou1/ArknightsAuthorization_Series/raw/main/Box_Id.json",this.latestVersion=this.latestVersion||"未知版本"}this.dataStatusMessage="正在下载干员数据...",o({url:this.dataUrl,method:"GET",timeout:15e3,success:t=>{if(200===t.statusCode){let o=t.data;if("string"==typeof o)try{o=JSON.parse(o)}catch(e){return console.error("JSON解析失败:",e),void(this.dataStatusMessage="数据格式错误")}if(Array.isArray(o)){const t=o.map((t=>{const e={};for(const o in t)"Box_id"===o?e[o]=String(t[o]||""):o.startsWith("character")?e[o]=t[o]:e[o]=String(t[o]||"");return e}));this.characterData=t,this.currentVersion=this.latestVersion||this.currentVersion||"未知版本",u({key:"arknightsData",data:t,success:()=>{const e=new Date;this.localUpdateTime=`${e.getFullYear()}-${(e.getMonth()+1).toString().padStart(2,"0")}-${e.getDate().toString().padStart(2,"0")} ${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}`,u({key:"localUpdateTime",data:this.localUpdateTime}),u({key:"cloudUpdateTime",data:this.cloudUpdateTime}),u({key:"dataVersion",data:this.currentVersion}),u({key:"dataUrl",data:this.dataUrl}),this.hasUpdate=!1,this.dataStatusMessage=`数据更新成功 ${this.currentVersion} (${t.length} 个盒号)`,i({title:"数据更新成功",icon:"success",duration:2e3}),this.autoUpdateEnabled&&(this.lastAutoUpdateCheckTime=this.formatLocalTime(new Date),this.calculateNextUpdateTime())},fail:t=>{console.error("存储数据失败:",t),this.dataStatusMessage="数据下载成功但存储失败"}})}else this.dataStatusMessage="数据格式不正确"}else this.dataStatusMessage=`服务器错误: ${t.statusCode}`},fail:t=>{console.error("下载数据失败:",t),this.dataStatusMessage="下载失败，请检查网络连接",0===this.characterData.length&&setTimeout((()=>{l({title:"网络错误",content:"无法下载干员数据，请检查网络连接后重试",showCancel:!1})}),500)}})},startEditingMode(){const e=t("toolsConfig");e&&e.length>0?this.toolsConfig=e:this.initDefaultToolsConfig(),this.editingTools=JSON.parse(JSON.stringify(this.toolsConfig)),this.isEditingTools=!0,p&&p()},cancelEditing(){this.isEditingTools=!1,this.editingTools=[]},saveToolsConfig(){this.editingTools.forEach(((t,e)=>{t.order=e+1})),this.toolsConfig=JSON.parse(JSON.stringify(this.editingTools)),e("toolsConfig",this.toolsConfig),this.isEditingTools=!1,this.editingTools=[],i({title:"配置已保存",icon:"success",duration:1500})},initDefaultToolsConfig(){this.toolsConfig=[{id:"search",name:"通行证查询",desc:"查询干员所在的盒号&盒内信息",icon:"/static/search-icon.png",url:"/pages/Search/Search",visible:!0,order:1,showNew:!1},{id:"list",name:"通行证列表",desc:"查看所有通行证及干员列表信息",icon:"/static/list-tool.png",url:"/pages/list/list",visible:!0,order:2,showNew:!1},{id:"gacha",name:"模拟抽卡",desc:"模拟通行证抽卡",icon:"/static/gacha_simulated-tool.png",url:"/packageB/pages/gacha_simulated/gacha_simulated",visible:!0,order:3,showNew:!1},{id:"mystarbox",name:"我的收藏",desc:"查看您收藏的通行证&干员",icon:"/static/mystarbox-tool.png",url:"/packageB/pages/mystarbox/mystarbox",visible:!0,order:4,showNew:!1},{id:"questionnaire",name:"前往元宝小程序帮查>",desc:"元宝小程序提供服务，仅供娱乐，精度较低、无法联系上下文，慎用！！",icon:"",url:"",visible:!0,order:5,showNew:!0,specialAction:"gotoaitools"},{id:"share",name:"分享通行证",desc:"对自己拥有的通行证进行炫耀/出物发布/换物分享",icon:"/static/share.png",url:"/pages/card_share/card_share",visible:!0,order:6,showNew:!0},{id:"questionnaire",name:"1月满意度调研",desc:"26年1月新功能满意度调查问卷",icon:"/static/questionnaire-tool.png",url:"",visible:!0,order:7,showNew:!1,specialAction:"gotoquestionnaire"},{id:"setting",name:"设置",desc:"部分特别功能个性化",icon:"/static/Setting-tool.png",url:"/packageA/Setting/Setting",visible:!0,order:8,showNew:!1},{id:"aboutus",name:"关于我们",desc:"了解我们及社媒账号",icon:"/static/aboutus-tool.png",url:"/packageA/aboutus/aboutus",visible:!0,order:9,showNew:!1},{id:"comingsoon",name:"敬请期待",desc:"新功能即将上线",icon:"/static/threepoint.png",url:"",visible:!0,order:10,showNew:!1,specialAction:"update"}],e("toolsConfig",this.toolsConfig)},startToolEditing(t){this.startEditingMode()},handleToolTouchStart(t,e){this.longPressTimer&&clearTimeout(this.longPressTimer),this.longPressTimer=setTimeout((()=>{this.startToolEditing(t),this.isLongPressing=!0}),800)},handleToolTouchEnd(){this.longPressTimer&&(clearTimeout(this.longPressTimer),this.longPressTimer=null),this.isLongPressing||(this.isLongPressing=!1)},toggleToolVisibility(t){this.isEditingTools?this.editingTools[t].visible=!this.editingTools[t].visible:this.tempToolsConfig[t].visible=!this.tempToolsConfig[t].visible},deleteTool(t){this.editingTools.length<=1?i({title:"至少保留一个工具",icon:"none"}):l({title:"确认删除",content:"确定要删除这个功能吗？删除后可以重置恢复",success:e=>{e.confirm&&(this.editingTools.splice(t,1),i({title:"删除成功",icon:"success"}))}})},resetToolsConfig(){l({title:"确认重置",content:"确定要重置工具箱配置为默认设置吗？",success:t=>{t.confirm&&(h("toolsConfig"),this.initDefaultToolsConfig(),this.isEditingTools&&this.startEditingMode(),i({title:"已重置为默认配置",icon:"success"}))}})},moveToolUp(t){if(t>1){const e=t-2,o=this.editingTools[t];this.editingTools[t]=this.editingTools[e],this.editingTools[e]=o,p&&p()}},moveToolDown(t){if(t<this.editingTools.length-2){const e=t+2,o=this.editingTools[t];this.editingTools[t]=this.editingTools[e],this.editingTools[e]=o,p&&p()}},moveToolLeft(t){if(t%2==1){const e=t-1,o=this.editingTools[t];this.editingTools[t]=this.editingTools[e],this.editingTools[e]=o,p&&p()}},moveToolRight(t){if(t%2==0&&t<this.editingTools.length-1){const e=t+1,o=this.editingTools[t];this.editingTools[t]=this.editingTools[e],this.editingTools[e]=o,p&&p()}},getVisibleTools(){return this.toolsConfig.filter((t=>t.visible)).sort(((t,e)=>t.order-e.order))},getVisibleCount(){return this.isEditingTools?this.editingTools.filter((t=>t.visible)).length:this.tempToolsConfig.filter((t=>t.visible)).length},handleToolClick(t){this.isEditingTools||(t.specialAction?"gotoquestionnaire"===t.specialAction?this.gotoquestionnaire():"gotoaitools"===t.specialAction?this.gotoaitools():"update"===t.specialAction&&this.update():t.url&&this.navigateTo(t.url))},initEasterEggs(){this.easterEggs=["3 2 5 ，你应该知道是什么意思吧？(本彩蛋灵感来源MAA)","big~super~cup!!!","正在连接至神经网络...","终于可以像别人一样在这里大胆写一些彩蛋了~","不管你是谁，请支持明日方舟和罗小黑战记二联！"]},handleCopyrightClick(){this.copyrightClickCount++,e("copyrightClickCount",this.copyrightClickCount),this.copyrightClickCount%3==0&&this.showEasterEggText(),1!==this.copyrightClickCount&&2!==this.copyrightClickCount||i({title:`再点击${3-this.copyrightClickCount}次`,icon:"none",duration:1e3})},showEasterEggText(){if(0===this.easterEggs.length)return void console.warn("彩蛋数组为空，请先在 initEasterEggs 方法中填写彩蛋内容");const t=Math.floor(Math.random()*this.easterEggs.length);this.easterEggText=this.easterEggs[t],this.showEasterEgg=!0,this.originalCopyrightTexts=[this.easterEggText,this.easterEggText]}}},[["render",function(t,e,o,s,i,a){const n=M,l=T,c=v,r=P(m("uni-notice-bar"),L),d=I,h=j,g=D,u=R;return A(),f(l,{class:"container"},{default:C((()=>[i.noticeContent&&i.showNotice?(A(),f(l,{key:0,class:"notice-section"},{default:C((()=>[w(l,{class:"notice-header"},{default:C((()=>[w(l,{class:"notice-close",onClick:k(a.closeNotice,["stop"])},{default:C((()=>[w(n,{class:"close-btn"},{default:C((()=>[U("×")])),_:1})])),_:1},8,["onClick"]),w(c,{class:"notice-icon",src:G}),w(n,{class:"notice-title"},{default:C((()=>[U("公告")])),_:1}),w(l,{class:"notice-toggle",onClick:k(a.toggleNoticeSection,["stop"])},{default:C((()=>[w(n,{class:"toggle-text"},{default:C((()=>[U(y(i.noticeSectionExpanded?"收起":"展开"),1)])),_:1}),w(c,{class:x(["toggle-icon",{rotate:!i.noticeSectionExpanded}]),src:"data:image/png;base64,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"},null,8,["class"])])),_:1},8,["onClick"])])),_:1}),w(l,{class:x(["notice-expandable",{expanded:i.noticeSectionExpanded,collapsed:!i.noticeSectionExpanded}])},{default:C((()=>[w(l,{class:"notice-bar-container"},{default:C((()=>[w(r,{"show-icon":"",scrollable:"","show-get-more":"",onGetmore:e[0]||(e[0]=t=>a.gotoMoreNotice()),"more-text":"查看更多>","more-color":"#409EFF",text:i.moreNoticeContent,speed:"75","background-color":"#e8f4ff",color:"#409EFF"},null,8,["text"])])),_:1}),w(l,{class:"notice-content"},{default:C((()=>[w(n,{class:x(["notice-text",{"text-collapsed":!i.noticeExpanded&&i.noticeOverflow,"text-expanded":i.noticeExpanded}]),ref:"noticeText"},{default:C((()=>[U(y(i.noticeContent),1)])),_:1},8,["class"]),w(l,{class:"notice-expand"},{default:C((()=>[w(d,{style:{width:"80%"}}),i.noticeOverflow?(A(),f(d,{key:0,class:"expand-btn",onClick:a.toggleNoticeExpand},{default:C((()=>[U(y(i.noticeExpanded?"收起 ↑":"展开 ↓"),1)])),_:1},8,["onClick"])):b("",!0)])),_:1})])),_:1})])),_:1},8,["class"])])),_:1})):b("",!0),i.carouselImages.length>0?(A(),f(l,{key:1,class:"carousel-section"},{default:C((()=>[w(g,{class:"carousel","indicator-dots":"true",autoplay:"true",interval:"3000",duration:"500",circular:"true"},{default:C((()=>[(A(!0),S(N,null,E(i.carouselImages,((t,e)=>(A(),f(h,{key:e},{default:C((()=>[w(c,{class:"carousel-image",src:t.imageUrl,mode:"aspectFill",onClick:e=>a.onCarouselItemClick(t)},null,8,["src","onClick"])])),_:2},1024)))),128))])),_:1})])),_:1})):b("",!0),w(l,{class:"tools-section"},{default:C((()=>[w(l,{class:"tools-header"},{default:C((()=>[w(n,{class:"tools-title"},{default:C((()=>[U("明日方舟通行证-工具箱")])),_:1}),w(l,{class:"tools-manage-btn",onClick:a.toggleToolManagement},{default:C((()=>[w(n,{class:"manage-text"},{default:C((()=>[U(y(i.isEditingTools?"完成":"管理"),1)])),_:1}),w(c,{class:"manage-icon",src:O})])),_:1},8,["onClick"])])),_:1}),i.isEditingTools?(A(),f(l,{key:1,class:"tools-grid editing"},{default:C((()=>[(A(!0),S(N,null,E(i.editingTools,((t,e)=>(A(),f(l,{class:"tool-card editing-card",key:t.id},{default:C((()=>[w(l,{class:"tool-icon-container editing"},{default:C((()=>[w(c,{class:"tool-icon",src:t.icon},null,8,["src"]),t.showNew?(A(),f(c,{key:0,class:"new-badge",src:B})):b("",!0)])),_:2},1024),w(l,{class:"tool-info editing"},{default:C((()=>[w(n,{class:"tool-name"},{default:C((()=>[U(y(t.name),1)])),_:2},1024),w(n,{class:"tool-desc"},{default:C((()=>[U(y(t.desc),1)])),_:2},1024),w(l,{class:"tool-edit-controls"},{default:C((()=>[w(n,{class:"visibility-label"},{default:C((()=>[U(y(t.visible?"显示":"隐藏"),1)])),_:2},1024),w(u,{checked:t.visible,onChange:t=>a.toggleToolVisibility(e),color:"#409EFF",class:"visibility-switch"},null,8,["checked","onChange"])])),_:2},1024)])),_:2},1024),i.editingTools.length>1?(A(),f(l,{key:0,class:"delete-btn",onClick:k((t=>a.deleteTool(e)),["stop"])},{default:C((()=>[w(n,{class:"delete-text"},{default:C((()=>[U("×")])),_:1})])),_:2},1032,["onClick"])):b("",!0),w(l,{class:"sort-arrows"},{default:C((()=>[e>0?(A(),f(l,{key:0,class:"arrow-btn arrow-up",onClick:k((t=>a.moveToolUp(e)),["stop"])},{default:C((()=>[w(c,{class:"arrow-icon",src:_,style:{transform:"rotate(-90deg)"}})])),_:2},1032,["onClick"])):b("",!0),e<i.editingTools.length-1?(A(),f(l,{key:1,class:"arrow-btn arrow-down",onClick:k((t=>a.moveToolDown(e)),["stop"])},{default:C((()=>[w(c,{class:"arrow-icon",src:_,style:{transform:"rotate(90deg)"}})])),_:2},1032,["onClick"])):b("",!0),e%2==1?(A(),f(l,{key:2,class:"arrow-btn arrow-left",onClick:k((t=>a.moveToolLeft(e)),["stop"])},{default:C((()=>[w(c,{class:"arrow-icon",src:_,style:{transform:"rotate(180deg)"}})])),_:2},1032,["onClick"])):b("",!0),e%2==0&&e<i.editingTools.length-1?(A(),f(l,{key:3,class:"arrow-btn arrow-right",onClick:k((t=>a.moveToolRight(e)),["stop"])},{default:C((()=>[w(c,{class:"arrow-icon",src:_})])),_:2},1032,["onClick"])):b("",!0)])),_:2},1024)])),_:2},1024)))),128))])),_:1})):(A(),f(l,{key:0,class:"tools-grid"},{default:C((()=>[(A(!0),S(N,null,E(a.getVisibleTools(),(t=>(A(),f(l,{class:"tool-card",key:t.id,onClick:e=>a.handleToolClick(t),onLongpress:e=>a.startToolEditing(t)},{default:C((()=>[w(l,{class:"tool-icon-container"},{default:C((()=>[w(c,{class:"tool-icon",src:t.icon},null,8,["src"]),t.showNew?(A(),f(c,{key:0,class:"new-badge",src:B})):b("",!0)])),_:2},1024),w(l,{class:"tool-info"},{default:C((()=>[w(n,{class:"tool-name"},{default:C((()=>[U(y(t.name),1)])),_:2},1024),w(n,{class:"tool-desc"},{default:C((()=>[U(y(t.desc),1)])),_:2},1024)])),_:2},1024),!i.isEditingTools&&i.showLongPressHint?(A(),f(l,{key:0,class:"longpress-hint"},{default:C((()=>[w(n,{class:"hint-text"},{default:C((()=>[U("长按进入编辑")])),_:1})])),_:1})):b("",!0)])),_:2},1032,["onClick","onLongpress"])))),128))])),_:1})),i.isEditingTools?(A(),f(l,{key:2,class:"edit-controls-bar"},{default:C((()=>[w(l,{class:"edit-info"},{default:C((()=>[w(n,{class:"info-text"},{default:C((()=>[U("点击箭头调整顺序，开关控制显示/隐藏")])),_:1}),w(n,{class:"info-text"},{default:C((()=>[U("当前显示 "+y(a.getVisibleCount())+"/"+y(i.editingTools.length)+" 个功能",1)])),_:1})])),_:1}),w(l,{class:"edit-buttons"},{default:C((()=>[w(d,{class:"edit-btn reset",onClick:a.resetToolsConfig},{default:C((()=>[U(" 重置 ")])),_:1},8,["onClick"]),w(d,{class:"edit-btn cancel",onClick:a.cancelEditing},{default:C((()=>[U(" 取消 ")])),_:1},8,["onClick"]),w(d,{class:"edit-btn save",onClick:a.saveToolsConfig},{default:C((()=>[U(" 保存 ")])),_:1},8,["onClick"])])),_:1})])),_:1})):b("",!0)])),_:1}),w(l,{class:"update-section"},{default:C((()=>[w(d,{class:"update-btn",onClick:a.downloadData},{default:C((()=>[U("更新干员数据")])),_:1},8,["onClick"])])),_:1}),i.dataStatusMessage?(A(),f(l,{key:2,class:"data-status"},{default:C((()=>[i.hasUpdate&&!i.autoUpdateEnabled?(A(),f(l,{key:0,class:"update-hint"},{default:C((()=>[w(n,{class:"hint-text"},{default:C((()=>[U("当前数据版本有更新，您可以点击上方的更新干员数据按钮来手动更新")])),_:1})])),_:1})):b("",!0),w(l,{class:"data-status-main"},{default:C((()=>[w(n,{class:"status-text"},{default:C((()=>[U(y(i.dataStatusMessage),1)])),_:1}),w(l,{class:"data-status-actions"},{default:C((()=>[i.dataStatusMessage&&(i.dataStatusMessage.includes("失败")||i.dataStatusMessage.includes("错误"))?(A(),f(d,{key:0,class:"update-btn small",onClick:a.downloadData},{default:C((()=>[U("重试下载")])),_:1},8,["onClick"])):b("",!0)])),_:1})])),_:1}),i.localUpdateTime||i.cloudUpdateTime||i.currentVersion?(A(),f(l,{key:1,class:"data-details"},{default:C((()=>[i.localUpdateTime?(A(),f(n,{key:0,class:"data-detail-item"},{default:C((()=>[U("本地上次更新: "+y(i.localUpdateTime),1)])),_:1})):b("",!0),i.cloudUpdateTime?(A(),f(n,{key:1,class:"data-detail-item"},{default:C((()=>[U("云端最新更新: "+y(a.formatCloudTime(i.cloudUpdateTime)),1)])),_:1})):b("",!0),i.characterData.length>0?(A(),f(n,{key:2,class:"data-detail-item"},{default:C((()=>[U("当前数据: "+y(i.characterData.length)+" 个盒号",1)])),_:1})):b("",!0),i.currentVersion?(A(),f(n,{key:3,class:"data-detail-item"},{default:C((()=>[U("数据版本: "+y(i.currentVersion),1)])),_:1})):b("",!0),i.latestVersion&&i.latestVersion!==i.currentVersion?(A(),f(n,{key:4,class:"data-detail-item"},{default:C((()=>[U("最新版本: "+y(i.latestVersion),1)])),_:1})):b("",!0)])),_:1})):b("",!0)])),_:1})):b("",!0),w(l,{class:"about-link-section"},{default:C((()=>[w(l,{class:"footer-section"},{default:C((()=>[w(n,{class:"copyright-text",onClick:a.handleCopyrightClick},{default:C((()=>[U(y(i.originalCopyrightTexts[0]),1)])),_:1},8,["onClick"]),w(n,{class:"copyright-text",onClick:a.handleCopyrightClick},{default:C((()=>[U(y(i.originalCopyrightTexts[1]),1)])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-d039bbc1"]]);export{z as default};
