import{I as t,r as a,g as e,s as r,n as s,b as o,m as i,w as l,o as c,p as n,q as h,u as d,x as u,z as g,y as f,A as p,B as m,F as _,t as k,C as x,J as y,E as v,D as C,K as B}from"./index-BAWL4vNb.js";import{_ as S}from"./hot.ChjTii81.js";import{_ as M}from"./empty-icon.8qvP3JRT.js";import{_ as I}from"./_plugin-vue_export-helper.BCo6x5W8.js";const D={clientId:"21680db9b1362913357c",baseUrl:"https://21680db9b1362913357c.myminapp.com/hserve/v2.2",tableNames:{Version:"Version"}};const b=I({data:()=>({characterData:[],filteredData:[],currentPage:1,pageSize:5,dataStatusMessage:"",cloudUpdateTime:"",localUpdateTime:"",currentVersion:"",dataUrl:"",defaultAvatar:"/static/default-avatar.png",avatarCache:{},filterIndex:0,filterOptions:["å…¨éƒ¨ç›’ç±»å‹","å¸¸è§„æ¬¾","ç™½åå•å‡­è¯","ç‰¹åˆ«é€šè¡Œè®¤è¯","è”åŠ¨æ¬¾","éŸ³å¾‹è”è§‰é€šè¡Œè¯"],filterMap:{0:"all",1:"normal",2:"whitelist",3:"special",4:"cooperation",5:"ambience"},sortIndex:0,sortOrder:"asc",sortOptions:["æŒ‰ç›’å·æ’åº","æŒ‰å¹²å‘˜æ•°é‡æ’åº"],favoriteBoxIds:[],favoriteCharacterNames:[],showBoxCharactersModal:!1,currentBoxId:"",modalBoxCharacters:[],retryCount:0,latestVersion:"",showMarketPrice:!1,hasMarketPriceData:!1}),computed:{totalPages(){return Math.ceil(this.filteredData.length/this.pageSize)},currentPageData(){const t=(this.currentPage-1)*this.pageSize,a=t+this.pageSize;return this.filteredData.slice(t,a)},currentFilter(){return this.filterMap[this.filterIndex]||"all"},isAllSelected(){return 0!==this.modalBoxCharacters.length&&this.modalBoxCharacters.every((t=>this.isFavoriteCharacter(t.name)))}},watch:{filterIndex(){this.applyFilterAndSort()},sortIndex(){this.applyFilterAndSort()},sortOrder(){this.applyFilterAndSort()}},onLoad(){t({title:"æ˜æ—¥æ–¹èˆŸé€šè¡Œè¯åˆ—è¡¨å·¥å…·"}),console.log("ç›’å·åˆ—è¡¨é¡µé¢åŠ è½½ï¼Œå¼€å§‹åˆå§‹åŒ–æ•°æ®..."),this.loadLocalData(),this.loadFavorites()},onShow(){this.loadFavorites(),this.loadMarketPriceSetting()},onShareAppMessage:()=>({title:"æ–¹èˆŸé€šè¡Œè¯è°·å­æŸ¥è¯¢å·¥å…·-é€šè¡Œè¯ç›’å·åˆ—è¡¨",path:"/pages/list/list",imageUrl:""}),onShareTimeline:()=>({title:"æ–¹èˆŸé€šè¡Œè¯è°·å­æŸ¥è¯¢å·¥å…·-é€šè¡Œè¯ç›’å·åˆ—è¡¨",imageUrl:""}),methods:{async knowCloudRequest(t,e={},r=0){if(r>3)throw console.error("çŸ¥æ™“äº‘è¯·æ±‚é‡è¯•æ¬¡æ•°è¿‡å¤š"),new Error("çŸ¥æ™“äº‘è¯·æ±‚é‡è¯•æ¬¡æ•°è¿‡å¤š");try{const r=D.tableNames[t];if(!r)throw new Error(`æœªæ‰¾åˆ°è¡¨ ${t} çš„é…ç½®`);let s=`${D.baseUrl}/table/${r}/record/`;if(e.data){const t=[];Object.keys(e.data).forEach((a=>{t.push(`${a}=${encodeURIComponent(e.data[a])}`)})),t.length>0&&(s+=`?${t.join("&")}`)}const o={url:s,method:e.method||"GET",header:{"X-Hydrogen-Client-ID":D.clientId,"Content-Type":"application/json"},timeout:15e3,...e};e.header&&Object.assign(o.header,e.header),console.log("å‘é€çŸ¥æ™“äº‘è¯·æ±‚:",o.url);const i=await a(o);if(console.log("çŸ¥æ™“äº‘å“åº”çŠ¶æ€:",i.statusCode),200===i.statusCode)return i.data;throw console.error("çŸ¥æ™“äº‘è¯·æ±‚é”™è¯¯:",i.statusCode,i.data),new Error(`è¯·æ±‚å¤±è´¥: ${i.statusCode}`)}catch(s){if(console.error(`çŸ¥æ™“äº‘è¯·æ±‚å¤±è´¥ (${t}):`,s),r<3)return console.log(`ç¬¬${r+1}æ¬¡é‡è¯•...`),await this.knowCloudRequest(t,e,r+1);throw s}},async getDataUrlFromMinapp(){try{const t=await this.knowCloudRequest("Version",{data:{limit:1,offset:0}});if(console.log("çŸ¥æ™“äº‘ç‰ˆæœ¬ä¿¡æ¯å“åº”:",t),t&&t.objects&&t.objects.length>0){const a=t.objects[0];return console.log("ç‰ˆæœ¬æ•°æ®:",a),{url:a.url||"",version:a.version||a.Version||"",cloudUpdateTime:a.updated_at||a.created_at||""}}throw console.error("çŸ¥æ™“äº‘è¿”å›æ•°æ®æ ¼å¼ä¸æ­£ç¡®:",t),new Error("æœªæ‰¾åˆ°ç‰ˆæœ¬æ•°æ®æˆ–æ•°æ®æ ¼å¼ä¸æ­£ç¡®")}catch(t){throw console.error("ä»çŸ¥æ™“äº‘è·å–URLå¤±è´¥:",t),t}},loadMarketPriceSetting(){try{const t=e("showMarketPrice");console.log("ä»æœ¬åœ°å­˜å‚¨è¯»å–å¸‚ä»·è®¾ç½®:",t),null==t?(this.showMarketPrice=!1,r("showMarketPrice","false")):this.showMarketPrice="true"===t,console.log("åŠ è½½åçš„å¸‚ä»·è®¾ç½®:",this.showMarketPrice),this.checkMarketPriceData()}catch(t){console.error("åŠ è½½å¸‚ä»·è®¾ç½®å¤±è´¥:",t),this.showMarketPrice=!1}},checkMarketPriceData(){if(!this.characterData||0===this.characterData.length)return this.hasMarketPriceData=!1,void console.log("æš‚æ— æ•°æ®ï¼Œæ— æ³•æ£€æŸ¥å¸‚ä»·æ•°æ®");let t=!1;console.log("å¼€å§‹æ£€æŸ¥å¸‚ä»·æ•°æ®ï¼Œæ•°æ®é•¿åº¦:",this.characterData.length);for(let a=0;a<Math.min(this.characterData.length,5);a++){const e=this.characterData[a];console.log(`æ£€æŸ¥ç¬¬${a+1}ä¸ªç›’å·:`,e.Box_id);for(let a=1;a<=10;a++){const r=`character${a}`;if(e[r]&&"object"==typeof e[r]){const a=e[r];if(console.log(`  ${a.name}: market_price =`,a.market_price),a.market_price&&(a.market_price.ELITE1||a.market_price.ELITE2)){t=!0,console.log("å‘ç°å¸‚ä»·æ•°æ®:",a.market_price);break}}}if(t)break}this.hasMarketPriceData=t,console.log("æ£€æŸ¥å¸‚ä»·æ•°æ®ç»“æœ:",this.hasMarketPriceData?"æœ‰å¸‚ä»·æ•°æ®":"æ— å¸‚ä»·æ•°æ®")},getBoxCharacters(t){const a=[];for(let e=1;e<=10;e++){const r=`character${e}`;if(t[r]){let e="",s="",o=!1,i=!1,l=null,c=!1;"string"==typeof t[r]?(e=t[r],s="",o=!1,i=!1,l=null,c=!1):t[r]&&t[r].name&&(e=t[r].name,s=t[r].imageUrl||"",o=!0===t[r].nolyELITE1,i=!0===t[r].hotcharacter,l=t[r].market_price||null,c=l&&(l.ELITE1||l.ELITE2)),e&&e.trim()&&a.push({name:e,avatar:s||this.defaultAvatar,nolyELITE1:o,hotcharacter:i,market_price:l,hasMarketPrice:c})}}return a},goToSettings(){s({url:"/packageA/Setting/Setting"})},saveDataWithValidation(t){var a,s,o;try{console.log("å°è¯•æ–¹æ³•1ï¼šç›´æ¥å­˜å‚¨åŸå§‹æ•°æ®"),r("arknightsData",t);const i=e("arknightsData");if(console.log("å­˜å‚¨åéªŒè¯ - æ•°æ®ç±»å‹:",typeof i),console.log("å­˜å‚¨åéªŒè¯ - ç¬¬ä¸€ä¸ªå…ƒç´ :",i[0]),console.log("å­˜å‚¨åéªŒè¯ - Box_info ç±»å‹:",typeof(null==(a=i[0])?void 0:a.Box_info)),console.log("å­˜å‚¨åéªŒè¯ - Box_info å€¼:",null==(s=i[0])?void 0:s.Box_info),!i||!Array.isArray(i)||"string"==typeof(null==(o=i[0])?void 0:o.Box_info))return console.log("æ–¹æ³•1å¤±è´¥ï¼Œå°è¯•æ–¹æ³•2ï¼šå­—ç¬¦ä¸²å­˜å‚¨"),void this.saveDataAsString(t);this.characterData=i,this.applyFilterAndSort(),this.updateLocalInfo(),this.dataStatusMessage=`æ•°æ®åŠ è½½æˆåŠŸ (${i.length} ä¸ªç›’å·)`,this.checkMarketPriceData()}catch(i){console.error("æ•°æ®å­˜å‚¨å¤±è´¥:",i),this.dataStatusMessage="æ•°æ®å­˜å‚¨å¤±è´¥"}},saveDataAsString(t){var a,s;try{console.log("ä½¿ç”¨å­—ç¬¦ä¸²æ–¹å¼å­˜å‚¨æ•°æ®");const o=JSON.stringify(t);r("arknightsDataString",o);const i=e("arknightsDataString");if(i){const t=JSON.parse(i);console.log("å­—ç¬¦ä¸²å­˜å‚¨éªŒè¯ - Box_info ç±»å‹:",typeof(null==(a=t[0])?void 0:a.Box_info)),console.log("å­—ç¬¦ä¸²å­˜å‚¨éªŒè¯ - Box_info å€¼:",null==(s=t[0])?void 0:s.Box_info),this.characterData=t,this.applyFilterAndSort(),this.updateLocalInfo(),this.dataStatusMessage=`æ•°æ®åŠ è½½æˆåŠŸ (${t.length} ä¸ªç›’å·)`,this.checkMarketPriceData()}}catch(o){console.error("å­—ç¬¦ä¸²å­˜å‚¨å¤±è´¥:",o),this.dataStatusMessage="æ•°æ®å­˜å‚¨å¤±è´¥"}},goToBoxInfo(t){s({url:`/pages/box_info/box_info?boxId=${t}`})},formatCloudTime(t){if(!t)return"";try{const a=new Date(t);return`${a.getFullYear()}-${(a.getMonth()+1).toString().padStart(2,"0")}-${a.getDate().toString().padStart(2,"0")} ${a.getHours().toString().padStart(2,"0")}:${a.getMinutes().toString().padStart(2,"0")}`}catch(a){return console.error("æ ¼å¼åŒ–äº‘ç«¯æ—¶é—´å¤±è´¥:",a),t}},async loadLocalData(){try{const t=e("arknightsData"),a=e("localUpdateTime"),r=e("cloudUpdateTime"),s=e("dataVersion"),o=e("dataUrl"),i=e("enableGuessData"),l=e("guessData");let c=[];t&&Array.isArray(t)&&t.length>0&&(c=[...t],this.dataStatusMessage=`å·²åŠ è½½æœ¬åœ°æ•°æ® (${t.length} ä¸ªç›’å·)`),"true"===i&&l&&Array.isArray(l)&&l.length>0&&(c=[...c,...l],this.dataStatusMessage+=` + é¢„æµ‹æ•°æ® (${l.length} ä¸ªç›’å·)`),c.length>0?(this.characterData=c,this.applyFilterAndSort(),this.localUpdateTime=a||"",this.cloudUpdateTime=r||"",this.currentVersion=s||"",this.dataUrl=o||"",this.currentVersion?setTimeout((()=>{this.checkForUpdates()}),1e3):this.checkForUpdates()):(this.dataStatusMessage="æ­£åœ¨è·å–æ•°æ®ä¿¡æ¯...",this.checkForUpdates())}catch(t){console.error("åŠ è½½æœ¬åœ°æ•°æ®å¤±è´¥:",t),this.dataStatusMessage="åŠ è½½æœ¬åœ°æ•°æ®å¤±è´¥ï¼Œæ­£åœ¨å°è¯•è·å–æœ€æ–°æ•°æ®...",this.checkForUpdates()}},async checkForUpdates(){try{this.dataStatusMessage="æ­£åœ¨æ£€æŸ¥æ›´æ–°...";const t=await this.getDataUrlFromMinapp();console.log("è·å–åˆ°çš„ç‰ˆæœ¬ä¿¡æ¯:",t),this.dataUrl=t.url,this.cloudUpdateTime=t.cloudUpdateTime,this.latestVersion=t.version,r("cloudUpdateTime",this.cloudUpdateTime);const a=e("dataVersion");console.log("æœ¬åœ°ç‰ˆæœ¬:",a,"äº‘ç«¯ç‰ˆæœ¬:",this.latestVersion),a&&a===this.latestVersion?(this.currentVersion=a,this.dataStatusMessage=`æ•°æ®å·²æ˜¯æœ€æ–°ç‰ˆæœ¬ (${this.currentVersion})`,0===this.characterData.length&&this.loadData()):this.dataStatusMessage=`å½“å‰æœ‰æ–°ç‰ˆæœ¬ (${this.latestVersion}),å»ºè®®å°½å¿«æ›´æ–°`}catch(t){console.error("æ£€æŸ¥æ›´æ–°å¤±è´¥:",t),this.dataStatusMessage="æ£€æŸ¥æ›´æ–°å¤±è´¥ï¼Œä½¿ç”¨å¤‡ç”¨URL",this.dataUrl="https://raw.gitcode.com/huangjinzhou1/ArknightsAuthorization_Series/raw/main/Box_Id.json",this.currentVersion||(this.currentVersion="æœªçŸ¥ç‰ˆæœ¬"),0===this.characterData.length&&this.loadData()}},async loadData(){if(!this.latestVersion)try{const t=await this.getDataUrlFromMinapp();this.dataUrl=t.url,this.latestVersion=t.version,this.cloudUpdateTime=t.cloudUpdateTime||this.cloudUpdateTime}catch(t){console.error("è·å–æ•°æ®URLå¤±è´¥:",t),this.dataUrl="https://raw.gitcode.com/huangjinzhou1/ArknightsAuthorization_Series/raw/main/Box_Id.json",this.latestVersion=this.latestVersion||"æœªçŸ¥ç‰ˆæœ¬"}this.dataUrl||(this.dataUrl="https://raw.gitcode.com/huangjinzhou1/ArknightsAuthorization_Series/raw/main/Box_Id.json"),this.dataStatusMessage="æ­£åœ¨ä¸‹è½½å¹²å‘˜æ•°æ®...",a({url:this.dataUrl,method:"GET",timeout:15e3,success:t=>{var a,e;if(200===t.statusCode){let s=t.data;if("string"==typeof s)try{s=JSON.parse(s)}catch(r){return console.error("JSONè§£æå¤±è´¥:",r),void(this.dataStatusMessage="æ•°æ®æ ¼å¼é”™è¯¯")}Array.isArray(s)?(console.log("åŸå§‹æ•°æ®ç±»å‹:",typeof s),console.log("åŸå§‹æ•°æ®ç¬¬ä¸€ä¸ªå…ƒç´ :",s[0]),console.log("Box_info åŸå§‹ç±»å‹:",typeof(null==(a=s[0])?void 0:a.Box_info)),console.log("Box_info åŸå§‹å€¼:",null==(e=s[0])?void 0:e.Box_info),this.validateDataStructure(s),this.saveDataWithValidation(s)):this.dataStatusMessage="æ•°æ®æ ¼å¼ä¸æ­£ç¡®"}else this.dataStatusMessage=`æœåŠ¡å™¨é”™è¯¯: ${t.statusCode}`},fail:t=>{console.error("ä¸‹è½½æ•°æ®å¤±è´¥:",t),this.dataStatusMessage="ä¸‹è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥"}})},validateDataStructure(t){if(!Array.isArray(t))return void console.error("æ•°æ®ä¸æ˜¯æ•°ç»„");const a=t[0];a?(console.log("=== æ•°æ®ç»“æ„éªŒè¯ ==="),console.log("Box_id:",a.Box_id),console.log("Box_info ç±»å‹:",typeof a.Box_info),console.log("Box_info å€¼:",a.Box_info),console.log("Box_ImageUrl:",a.Box_ImageUrl),console.log("character1 ç±»å‹:",typeof a.character1),console.log("character1 å€¼:",a.character1),console.log("=== éªŒè¯ç»“æŸ ===")):console.error("æ•°æ®ä¸ºç©º")},saveDataWithValidation(t){var a,s,o;try{console.log("å°è¯•æ–¹æ³•1ï¼šç›´æ¥å­˜å‚¨åŸå§‹æ•°æ®"),r("arknightsData",t);const i=e("arknightsData");if(console.log("å­˜å‚¨åéªŒè¯ - æ•°æ®ç±»å‹:",typeof i),console.log("å­˜å‚¨åéªŒè¯ - ç¬¬ä¸€ä¸ªå…ƒç´ :",i[0]),console.log("å­˜å‚¨åéªŒè¯ - Box_info ç±»å‹:",typeof(null==(a=i[0])?void 0:a.Box_info)),console.log("å­˜å‚¨åéªŒè¯ - Box_info å€¼:",null==(s=i[0])?void 0:s.Box_info),!i||!Array.isArray(i)||"string"==typeof(null==(o=i[0])?void 0:o.Box_info))return console.log("æ–¹æ³•1å¤±è´¥ï¼Œå°è¯•æ–¹æ³•2ï¼šå­—ç¬¦ä¸²å­˜å‚¨"),void this.saveDataAsString(t);this.characterData=i,this.applyFilterAndSort(),this.updateLocalInfo(),this.dataStatusMessage=`æ•°æ®åŠ è½½æˆåŠŸ (${i.length} ä¸ªç›’å·)`}catch(i){console.error("æ•°æ®å­˜å‚¨å¤±è´¥:",i),this.dataStatusMessage="æ•°æ®å­˜å‚¨å¤±è´¥"}},saveDataAsString(t){var a,s;try{console.log("ä½¿ç”¨å­—ç¬¦ä¸²æ–¹å¼å­˜å‚¨æ•°æ®");const o=JSON.stringify(t);r("arknightsDataString",o);const i=e("arknightsDataString");if(i){const t=JSON.parse(i);console.log("å­—ç¬¦ä¸²å­˜å‚¨éªŒè¯ - Box_info ç±»å‹:",typeof(null==(a=t[0])?void 0:a.Box_info)),console.log("å­—ç¬¦ä¸²å­˜å‚¨éªŒè¯ - Box_info å€¼:",null==(s=t[0])?void 0:s.Box_info),this.characterData=t,this.applyFilterAndSort(),this.updateLocalInfo(),this.dataStatusMessage=`æ•°æ®åŠ è½½æˆåŠŸ (${t.length} ä¸ªç›’å·)`}}catch(o){console.error("å­—ç¬¦ä¸²å­˜å‚¨å¤±è´¥:",o),this.dataStatusMessage="æ•°æ®å­˜å‚¨å¤±è´¥"}},updateLocalInfo(){const t=new Date;this.localUpdateTime=`${t.getFullYear()}-${(t.getMonth()+1).toString().padStart(2,"0")}-${t.getDate().toString().padStart(2,"0")} ${t.getHours().toString().padStart(2,"0")}:${t.getMinutes().toString().padStart(2,"0")}`,this.currentVersion=this.latestVersion||this.currentVersion||"æœªçŸ¥ç‰ˆæœ¬",r("localUpdateTime",this.localUpdateTime),r("cloudUpdateTime",this.cloudUpdateTime),r("dataVersion",this.currentVersion),r("dataUrl",this.dataUrl)},getBoxCharacters(t){const a=[];for(let e=1;e<=10;e++){const r=`character${e}`;if(t[r]){let e="",s="",o=!1,i=!1,l=null;"string"==typeof t[r]?(e=t[r],s="",o=!1,i=!1,l=null):t[r].name&&(e=t[r].name,s=t[r].imageUrl||"",o=!0===t[r].nolyELITE1,i=!0===t[r].hotcharacter,l=t[r].market_price||null),e&&e.trim()&&a.push({name:e,avatar:s||this.defaultAvatar,nolyELITE1:o,hotcharacter:i,market_price:l})}}return a},onAvatarLoad(t,a){console.log(`å¤´åƒåŠ è½½æˆåŠŸ: ç›’${t}å¹²å‘˜${a}`);const e=`${t}_${a}`;this.$set(this.avatarCache,e,!0)},onAvatarError(t,a){console.error(`å¤´åƒåŠ è½½å¤±è´¥: ç›’${t}å¹²å‘˜${a}`);const e=`${t}_${a}`;this.$set(this.avatarCache,e,!1)},onModalAvatarError(t){this.$set(this.modalBoxCharacters[t],"avatar",this.defaultAvatar)},onFilterChange(t){this.filterIndex=parseInt(t.detail.value),this.currentPage=1},applyFilterAndSort(){let t=[...this.characterData];"all"!==this.currentFilter&&(t=t.filter((t=>{const a=t.Box_type||"normal";return"normal"===this.currentFilter?!a||"normal"===a:a===this.currentFilter}))),0===this.sortIndex?t.sort(((t,a)=>{const e=t.Box_id||"",r=a.Box_id||"",s=t.Box_type||"normal",o=a.Box_type||"normal";return"asc"===this.sortOrder?this.compareBoxes(s,e,o,r):this.compareBoxes(o,r,s,e)})):1===this.sortIndex&&t.sort(((t,a)=>{const e=this.getCharacterCount(t),r=this.getCharacterCount(a);return"asc"===this.sortOrder?e-r:r-e})),this.filteredData=t},compareBoxes(t,a,e,r){const s=this.getBoxTypePriority(t),o=this.getBoxTypePriority(e);return s!==o?s-o:"normal"===t?this.compareNormalBoxIds(a,r):a.localeCompare(r,"zh-CN")},compareNormalBoxIds(t,a){return this.extractNumberFromId(t)-this.extractNumberFromId(a)},extractNumberFromId(t){const a=t.match(/(\d+(?:\.\d+)?)/);return a?parseFloat(a[1]):0},getCharacterCount(t){let a=0;for(let e=1;e<=10;e++){const r=`character${e}`;if(t[r]){let e="";"string"==typeof t[r]?e=t[r]:t[r].name&&(e=t[r].name),e&&e.trim()&&a++}}return a},getBoxTypePriority:t=>({normal:1,whitelist:2,special:3,cooperation:4,ambience:5}[t]||999),onSortChange(t){this.sortIndex=parseInt(t.detail.value)},toggleSortOrder(){this.sortOrder="asc"===this.sortOrder?"desc":"asc"},getBoxTypeText:t=>({whitelist:"ç™½åå•å‡­è¯",special:"ç‰¹åˆ«é€šè¡Œè®¤è¯",cooperation:"è”åŠ¨æ¬¾",ambience:"éŸ³å¾‹è”è§‰é€šè¡Œè¯",normal:"å¸¸è§„æ¬¾"}[t]||"å¸¸è§„æ¬¾"),getBoxTypeClass:t=>({whitelist:"type-whitelist",special:"type-special",cooperation:"type-cooperation",ambience:"type-ambience",normal:"type-normal"}[t]||"type-normal"),loadFavorites(){try{this.favoriteBoxIds=e("favoriteBoxIds")||[],this.favoriteCharacterNames=e("favoriteCharacterNames")||[],console.log("å·²æ”¶è—çš„ç›’å·:",this.favoriteBoxIds),console.log("å·²æ”¶è—çš„å¹²å‘˜:",this.favoriteCharacterNames)}catch(t){console.error("åŠ è½½æ”¶è—æ•°æ®å¤±è´¥:",t),this.favoriteBoxIds=[],this.favoriteCharacterNames=[]}},toggleFavorite(t){try{const a=this.favoriteBoxIds.indexOf(t);a>-1?(this.favoriteBoxIds.splice(a,1),o({title:"å·²å–æ¶ˆæ”¶è—",icon:"success"})):(this.favoriteBoxIds.push(t),o({title:"æ”¶è—æˆåŠŸ",icon:"success"})),r("favoriteBoxIds",this.favoriteBoxIds),this.$forceUpdate()}catch(a){console.error("æ“ä½œæ”¶è—å¤±è´¥:",a),o({title:"æ“ä½œå¤±è´¥",icon:"none"})}},isFavorite(t){return this.favoriteBoxIds.includes(t)},toggleFavoriteCharacter(t){try{const a=this.favoriteCharacterNames.indexOf(t);a>-1?(this.favoriteCharacterNames.splice(a,1),o({title:"å·²å–æ¶ˆæ”¶è—",icon:"success"})):(this.favoriteCharacterNames.push(t),o({title:"æ”¶è—æˆåŠŸ",icon:"success"})),r("favoriteCharacterNames",this.favoriteCharacterNames),this.$forceUpdate()}catch(a){o({title:"æ“ä½œå¤±è´¥",icon:"none"})}},toggleFavoriteCharacterDirectly(t){this.toggleFavoriteCharacter(t)},isFavoriteCharacter(t){return this.favoriteCharacterNames.includes(t)},selectAllCharacters(){this.isAllSelected?(this.modalBoxCharacters.forEach((t=>{const a=this.favoriteCharacterNames.indexOf(t.name);a>-1&&this.favoriteCharacterNames.splice(a,1)})),o({title:"å·²å–æ¶ˆå…¨é€‰",icon:"success"})):(this.modalBoxCharacters.forEach((t=>{this.favoriteCharacterNames.includes(t.name)||this.favoriteCharacterNames.push(t.name)})),o({title:"å·²å…¨é€‰",icon:"success"})),r("favoriteCharacterNames",this.favoriteCharacterNames),this.$forceUpdate()},openBoxCharactersModal(t,a){this.showBoxCharactersModal=!0,this.currentBoxId=t,this.modalBoxCharacters=a},hideBoxCharactersModal(){this.showBoxCharactersModal=!1,this.currentBoxId="",this.modalBoxCharacters=[]},prevPage(){this.currentPage>1&&this.currentPage--},nextPage(){this.currentPage<this.totalPages&&this.currentPage++},goToFirstPage(){this.currentPage=1},goToLastPage(){this.currentPage=this.totalPages}}},[["render",function(t,a,e,r,s,o){const I=x,D=c,b=y,P=v,T=C,E=B;return n(),i(D,{class:"container"},{default:l((()=>[h(D,{class:"control-section"},{default:l((()=>[h(D,{class:"filter-section"},{default:l((()=>[h(I,{class:"section-title"},{default:l((()=>[d("ç›’ç±»å‹ç­›é€‰ï¼š")])),_:1}),h(D,{class:"filter-controls"},{default:l((()=>[h(b,{class:"filter-picker",onChange:o.onFilterChange,value:s.filterIndex,range:s.filterOptions},{default:l((()=>[h(D,{class:"picker-text"},{default:l((()=>[d(u(s.filterOptions[s.filterIndex]),1)])),_:1})])),_:1},8,["onChange","value","range"])])),_:1})])),_:1}),h(D,{class:"sort-section"},{default:l((()=>[h(I,{class:"section-title"},{default:l((()=>[d("æ’åºæ–¹å¼ï¼š")])),_:1}),h(D,{class:"sort-controls"},{default:l((()=>[h(b,{class:"sort-picker",onChange:o.onSortChange,value:s.sortIndex,range:s.sortOptions},{default:l((()=>[h(D,{class:"picker-text"},{default:l((()=>[d(u(s.sortOptions[s.sortIndex]),1)])),_:1})])),_:1},8,["onChange","value","range"]),h(P,{class:"sort-order-btn",onClick:o.toggleSortOrder},{default:l((()=>[d(u("asc"===s.sortOrder?"å‡åº â†‘":"é™åº â†“"),1)])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1}),s.hasMarketPriceData?(n(),i(D,{key:0,class:"market-price-status-section"},{default:l((()=>[h(D,{class:f(["status-indicator",s.showMarketPrice?"enabled":"disabled"])},{default:l((()=>[h(I,{class:"status-text"},{default:l((()=>[d(u(s.showMarketPrice?"âœ“ æ­£åœ¨æ˜¾ç¤ºå¸‚ä»·ä¿¡æ¯":"â—‹ å¸‚ä»·ä¿¡æ¯å·²éšè—"),1)])),_:1}),s.showMarketPrice?g("",!0):(n(),i(I,{key:0,class:"status-tip"},{default:l((()=>[d(" å¦‚éœ€æ˜¾ç¤ºå¸‚ä»·ï¼Œè¯·å‰å¾€è®¾ç½®é¡µé¢å¼€å¯ ")])),_:1})),s.showMarketPrice?g("",!0):(n(),i(P,{key:1,class:"go-to-settings-btn",onClick:o.goToSettings},{default:l((()=>[d(" å‰å¾€è®¾ç½® ")])),_:1},8,["onClick"]))])),_:1},8,["class"])])),_:1})):g("",!0),h(D,{class:"pagination-section"},{default:l((()=>[h(D,{class:"pagination-info"},{default:l((()=>[h(I,{class:"page-text"},{default:l((()=>[d("ç¬¬ "+u(s.currentPage)+" é¡µ / å…± "+u(o.totalPages)+" é¡µ",1)])),_:1}),h(I,{class:"data-count"},{default:l((()=>[d("å…± "+u(s.filteredData.length)+" ç›’ (ç­›é€‰å)",1)])),_:1})])),_:1}),h(D,{class:"pagination-controls"},{default:l((()=>[h(P,{class:"page-btn",disabled:s.currentPage<=1,onClick:o.goToFirstPage},{default:l((()=>[d(" é¦–é¡µ ")])),_:1},8,["disabled","onClick"]),h(P,{class:"page-btn",disabled:s.currentPage<=1,onClick:o.prevPage},{default:l((()=>[d(" ä¸Šä¸€é¡µ ")])),_:1},8,["disabled","onClick"]),h(P,{class:"page-btn",disabled:s.currentPage>=o.totalPages,onClick:o.nextPage},{default:l((()=>[d(" ä¸‹ä¸€é¡µ ")])),_:1},8,["disabled","onClick"]),h(P,{class:"page-btn",disabled:s.currentPage>=o.totalPages,onClick:o.goToLastPage},{default:l((()=>[d(" å°¾é¡µ ")])),_:1},8,["disabled","onClick"])])),_:1})])),_:1}),s.dataStatusMessage?(n(),i(D,{key:1,class:"data-status"},{default:l((()=>[h(I,null,{default:l((()=>[d(u(s.dataStatusMessage),1)])),_:1}),s.dataStatusMessage&&(s.dataStatusMessage.includes("å¤±è´¥")||s.dataStatusMessage.includes("é”™è¯¯"))?(n(),i(P,{key:0,class:"update-btn small",onClick:o.loadData},{default:l((()=>[d(" é‡è¯•åŠ è½½ ")])),_:1},8,["onClick"])):g("",!0)])),_:1})):g("",!0),s.showMarketPrice&&s.hasMarketPriceData?(n(),i(D,{key:2,class:"market-price-hint"},{default:l((()=>[h(I,{class:"hint-text"},{default:l((()=>[d("ğŸ’¡ å¸‚ä»·ä¿¡æ¯æ¥æºäºåƒå²›APPï¼Œæ•°æ®ä»…ä¾›å‚è€ƒï¼Œè¯·ä»¥å®é™…ä¸ºå‡†")])),_:1})])),_:1})):g("",!0),o.currentPageData.length>0?(n(),i(D,{key:3,class:"boxes-list"},{default:l((()=>[(n(!0),p(_,null,m(o.currentPageData,((t,a)=>(n(),i(D,{class:"box-item",key:a},{default:l((()=>[h(D,{class:"box-header"},{default:l((()=>[h(D,{class:"box-header-left"},{default:l((()=>[h(I,{class:"box-id"},{default:l((()=>[d("ç›’å· "+u(t.Box_id),1)])),_:2},1024),h(I,{class:f(["box-type",o.getBoxTypeClass(t.Box_type)])},{default:l((()=>[d(u(o.getBoxTypeText(t.Box_type)),1)])),_:2},1032,["class"])])),_:2},1024),h(D,{class:"box-header-right"},{default:l((()=>[h(P,{class:"favorite-characters-btn",onClick:a=>o.openBoxCharactersModal(t.Box_id,o.getBoxCharacters(t))},{default:l((()=>[d(" æ”¶è— ")])),_:2},1032,["onClick"]),h(P,{class:"view-info-btn",onClick:a=>o.goToBoxInfo(t.Box_id)},{default:l((()=>[d(" æœ¬ç›’ä¿¡æ¯ ")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024),h(D,{class:"characters-grid"},{default:l((()=>[(n(!0),p(_,null,m(o.getBoxCharacters(t),((a,e)=>(n(),i(D,{class:"character-card",key:e,onClick:t=>o.toggleFavoriteCharacterDirectly(a.name)},{default:l((()=>[h(D,{class:"character-avatar-container"},{default:l((()=>[h(T,{class:"character-avatar",src:a.avatar,mode:"aspectFit",onError:a=>o.onAvatarError(t.Box_id,e),onLoad:a=>o.onAvatarLoad(t.Box_id,e)},null,8,["src","onError","onLoad"]),a.hotcharacter?(n(),i(T,{key:0,class:"hot-character-icon",src:S,mode:"aspectFit"})):g("",!0),h(D,{class:f(["favorite-indicator",o.isFavoriteCharacter(a.name)?"favorited":""])},{default:l((()=>[d(u(o.isFavoriteCharacter(a.name)?"â˜…":"â˜†"),1)])),_:2},1032,["class"])])),_:2},1024),h(D,{class:"character-info"},{default:l((()=>[h(D,{class:"character-name-line"},{default:l((()=>[h(I,{class:"character-name"},{default:l((()=>[d(u(a.name),1)])),_:2},1024),a.nolyELITE1?(n(),i(I,{key:0,class:"elite-tag"},{default:l((()=>[d("ä»…ç²¾ä¸€")])),_:1})):g("",!0)])),_:2},1024),s.showMarketPrice&&a.market_price?(n(),i(D,{key:0,class:"market-price-tags"},{default:l((()=>[a.market_price.ELITE1?(n(),i(I,{key:0,class:"price-tag elite1-tag"},{default:l((()=>[d(" ç²¾ä¸€ "+u(a.market_price.ELITE1)+"å…ƒ ",1)])),_:2},1024)):g("",!0),a.market_price.ELITE2&&!a.nolyELITE1?(n(),i(I,{key:1,class:"price-tag elite2-tag"},{default:l((()=>[d(" ç²¾äºŒ "+u(a.market_price.ELITE2)+"å…ƒ ",1)])),_:2},1024)):g("",!0)])),_:2},1024)):a.hasMarketPrice&&!s.showMarketPrice?(n(),i(D,{key:1,class:"price-disabled-hint"},{default:l((()=>[h(I,{class:"hint-text-small"},{default:l((()=>[d("å¸‚ä»·ä¿¡æ¯å·²éšè—")])),_:1})])),_:1})):g("",!0)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:2},1024)])),_:2},1024)))),128))])),_:1})):g("",!0),0!==s.filteredData.length||s.dataStatusMessage.includes("æ­£åœ¨")?g("",!0):(n(),i(D,{key:4,class:"empty-state"},{default:l((()=>[h(T,{class:"empty-icon",src:M}),h(I,{class:"empty-text"},{default:l((()=>[d("æš‚æ— æ•°æ®")])),_:1}),h(P,{class:"update-btn",onClick:o.loadData},{default:l((()=>[d("åŠ è½½æ•°æ®")])),_:1},8,["onClick"])])),_:1})),h(D,{class:"footer"},{default:l((()=>[s.localUpdateTime?(n(),i(I,{key:0,class:"update-info"},{default:l((()=>[d("æ–¹èˆŸé€šè¡Œè¯è°·å­æŸ¥è¯¢å·¥å…·")])),_:1})):g("",!0),s.cloudUpdateTime?(n(),i(I,{key:1,class:"update-info"},{default:l((()=>[d("æœ¬å·¥å…·ä¸ºç©å®¶è‡ªåˆ¶ï¼Œä¸å®˜æ–¹æ— å…³")])),_:1})):g("",!0),s.currentVersion?(n(),i(I,{key:2,class:"version-info"},{default:l((()=>[d("æ•°æ®ç‰ˆæœ¬: "+u(s.currentVersion),1)])),_:1})):g("",!0)])),_:1}),s.showBoxCharactersModal?(n(),i(D,{key:5,class:"image-modal",onClick:o.hideBoxCharactersModal},{default:l((()=>[h(D,{class:"image-modal-content",onClick:a[1]||(a[1]=k((()=>{}),["stop"]))},{default:l((()=>[h(D,{class:"image-modal-header"},{default:l((()=>[h(I,{class:"image-modal-title"},{default:l((()=>[d("æ”¶è—ç›’å· "+u(s.currentBoxId)+" å†…çš„å¹²å‘˜",1)])),_:1}),h(P,{class:"close-btn",onClick:o.hideBoxCharactersModal},{default:l((()=>[d("Ã—")])),_:1},8,["onClick"])])),_:1}),h(E,{class:"image-container","scroll-y":""},{default:l((()=>[h(D,{class:"box-characters-list"},{default:l((()=>[(n(!0),p(_,null,m(s.modalBoxCharacters,((t,a)=>(n(),i(D,{class:"box-character-item",key:a},{default:l((()=>[h(D,{class:"box-character-info"},{default:l((()=>[h(D,{class:"character-avatar-container"},{default:l((()=>[h(T,{class:"character-avatar",src:t.avatar,mode:"aspectFit",onError:t=>o.onModalAvatarError(a)},null,8,["src","onError"]),t.hotcharacter?(n(),i(T,{key:0,class:"hot-character-icon",src:S,mode:"aspectFit"})):g("",!0)])),_:2},1024),h(D,{class:"character-details"},{default:l((()=>[h(D,{class:"character-name-line"},{default:l((()=>[h(I,{class:"character-name"},{default:l((()=>[d(u(t.name),1)])),_:2},1024),t.nolyELITE1?(n(),i(I,{key:0,class:"elite-tag"},{default:l((()=>[d("ä»…ç²¾ä¸€")])),_:1})):g("",!0)])),_:2},1024),s.showMarketPrice&&t.market_price?(n(),i(D,{key:0,class:"market-price-tags"},{default:l((()=>[t.market_price.ELITE1?(n(),i(I,{key:0,class:"price-tag elite1-tag"},{default:l((()=>[d(" ç²¾ä¸€ "+u(t.market_price.ELITE1)+"å…ƒ ",1)])),_:2},1024)):g("",!0),t.market_price.ELITE2&&!t.nolyELITE1?(n(),i(I,{key:1,class:"price-tag elite2-tag"},{default:l((()=>[d(" ç²¾äºŒ "+u(t.market_price.ELITE2)+"å…ƒ ",1)])),_:2},1024)):g("",!0)])),_:2},1024)):t.hasMarketPrice&&!s.showMarketPrice?(n(),i(D,{key:1,class:"price-disabled-hint"},{default:l((()=>[h(I,{class:"hint-text-small"},{default:l((()=>[d("å¸‚ä»·ä¿¡æ¯å·²éšè—")])),_:1})])),_:1})):g("",!0)])),_:2},1024)])),_:2},1024),h(P,{class:f(["favorite-btn",o.isFavoriteCharacter(t.name)?"favorited":""]),onClick:a=>o.toggleFavoriteCharacter(t.name)},{default:l((()=>[d(u(o.isFavoriteCharacter(t.name)?"å·²æ”¶è—":"æ”¶è—"),1)])),_:2},1032,["class","onClick"])])),_:2},1024)))),128))])),_:1})])),_:1}),h(D,{class:"image-modal-footer"},{default:l((()=>[h(D,{class:"modal-footer-actions"},{default:l((()=>[h(P,{class:"select-all-btn",onClick:k(o.selectAllCharacters,["stop"])},{default:l((()=>[d(u(o.isAllSelected?"å–æ¶ˆå…¨é€‰":"å…¨é€‰"),1)])),_:1},8,["onClick"]),h(P,{class:f(["favorite-box-btn",o.isFavorite(s.currentBoxId)?"favorited":""]),onClick:a[0]||(a[0]=k((t=>o.toggleFavorite(s.currentBoxId)),["stop"]))},{default:l((()=>[d(u(o.isFavorite(s.currentBoxId)?"å·²æ”¶è—æœ¬ç›’":"æ”¶è—æœ¬ç›’"),1)])),_:1},8,["class"])])),_:1}),h(I,{class:"image-tip"},{default:l((()=>[d("ç‚¹å‡»å¹²å‘˜å³ä¾§çš„æ”¶è—æŒ‰é’®è¿›è¡Œæ”¶è—")])),_:1}),s.hasMarketPriceData?(n(),i(D,{key:0,class:"modal-market-price-switch"},{default:l((()=>[h(I,{class:"switch-label"},{default:l((()=>[d("æ˜¾ç¤ºå¸‚ä»·")])),_:1})])),_:1})):g("",!0)])),_:1})])),_:1})])),_:1},8,["onClick"])):g("",!0)])),_:1})}],["__scopeId","data-v-7e9e92b4"]]);export{b as default};
